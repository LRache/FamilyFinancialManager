<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡å®¶å©† - å®¶åº­è´¢åŠ¡ç®¡ç†</title>
    <script src="https://cdn.jsdelivr.net.cn/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .header {
            background: linear-gradient(135deg, #666 0%, #888 100%);
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .main-container {
            max-width: 1150px;
            margin: 80px auto 20px;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
        }

        /* ä¾§è¾¹æ  */
        .sidebar {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-title {
            font-size: 16px;
            font-weight: bold;
            color: #666;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f0f0f0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 5px;
            color: #666;
        }

        .menu-item:hover {
            background: #f8f8f8;
            color: #333;
        }

        .menu-item.active {
            background: linear-gradient(135deg, #666 0%, #888 100%);
            color: white;
        }

        /* ä¸»å†…å®¹åŒºåŸŸ */
        .content {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        /* é¡µé¢å†…å®¹åŒºåŸŸ */
        .page-content {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .page-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 30px;
            color: #333;
        }

        /* æ¦‚è§ˆå¡ç‰‡ */
        .overview-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .overview-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding-top: 25px;
            padding-bottom: 25px;
            border-radius: 15px;
            text-align: center;
            border-left: 5px solid #666;
        }

        .card-icon {
            font-size: 32px;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }

        .card-value {
            font-size: 28px;
            font-weight: bold;
            color: #333;
        }

        .card-change {
            font-size: 14px;
            margin-top: 5px;
        }

        .positive {
            color: #28a745;
        }

        .negative {
            color: #dc3545;
        }

        /* å¿«é€Ÿæ“ä½œæŒ‰é’® */
        .quick-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: space-around;
        }

        .action-btn {
            background: linear-gradient(135deg, #666 0%, #888 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-btn:hover {
            transform: translateY(-2px);
        }

        /* é¢„ç®—æ˜¾ç¤º */
        .budget-display {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #e8f5e8;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #28a745;
        }

        .budget-label {
            font-size: 14px;
            color: #28a745;
            font-weight: 500;
        }

        .budget-amount {
            font-size: 16px;
            color: #28a745;
            font-weight: bold;
        }

        /* å®¶åº­æˆå‘˜ç®¡ç† */
        .family-members {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .members-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .members-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .invite-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .members-list {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .member-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            min-width: 120px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .member-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #666 0%, #888 100%);
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .member-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .member-role {
            font-size: 12px;
            color: #666;
        }

        /* æœ€è¿‘äº¤æ˜“è®°å½• */
        .recent-transactions {
            margin-bottom: 30px;
        }

        .transactions-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .view-all-btn {
            color: #666;
            text-decoration: none;
            font-size: 14px;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .transaction-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .transaction-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .transaction-details h4 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .no-transactions {
            text-align: center;
            padding: 40px 20px;
            color: #999;
            font-size: 16px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 20px 0;
        }

        /* äº¤æ˜“è®°å½•å¼¹çª—æ ·å¼ */
        .transactions-modal-content {
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .transactions-list {
            max-height: 60vh;
            overflow-y: auto;
            padding: 10px 0;
        }

        .transactions-list .transaction-item {
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #ddd;
        }

        .transactions-list .transaction-item:last-child {
            margin-bottom: 0;
        }

        .transactions-list .amount-income {
            border-left-color: #28a745;
        }

        .transactions-list .amount-expense {
            border-left-color: #dc3545;
        }

        /* äº¤æ˜“è®°å½•ç­›é€‰æ§ä»¶æ ·å¼ */
        .transactions-controls {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            align-items: center;
            flex-wrap: wrap;
        }

        .category-filter,
        .member-filter {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-filter label,
        .member-filter label {
            font-weight: 500;
            color: #666;
            white-space: nowrap;
        }

        .category-filter select,
        .member-filter select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            font-size: 14px;
            min-width: 120px;
        }

        .category-filter select:focus,
        .member-filter select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        }

        /* æˆå‘˜åˆ—è¡¨æ ·å¼ */
        .members-income-section,
        .members-expense-section {
            margin: 30px 0;
        }

        .members-income-section h3,
        .members-expense-section h3 {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
        }

        .member-income-item,
        .member-expense-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #ddd;
        }

        .member-income-item {
            border-left-color: #28a745;
        }

        .member-expense-item {
            border-left-color: #dc3545;
        }

        .member-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .member-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #666 0%, #888 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
            font-weight: bold;
        }

        .member-details h4 {
            font-size: 16px;
            margin-bottom: 5px;
            color: #333;
        }

        .member-details p {
            font-size: 14px;
            color: #666;
            margin: 0;
        }

        .member-amount {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .transaction-details p {
            font-size: 14px;
            color: #666;
        }

        .transaction-amount {
            font-weight: bold;
            font-size: 16px;
        }

        .amount-income {
            color: #28a745;
        }

        .amount-expense {
            color: #dc3545;
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #888;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #666 0%, #888 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }

        .disable {
            display: none;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: static;
                margin-bottom: 20px;
            }

            .overview-cards {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                flex-direction: column;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .jieyu {
            font-size: 40px;
            color: #28a745;
        }

        .myTitle {
            display: flex;
            justify-content: space-between;
        }

        /* æœªåŠ å…¥å®¶åº­æç¤º */
        .no-family-notice {
            display: none;
            padding: 20px;
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
            border-radius: 8px;
            text-align: center;
            font-size: 16px;
            margin: 10px 0;
        }

        /* æ•°æ®ç»Ÿè®¡é¡µé¢æ ·å¼ */
        .statistics-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .time-range-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .time-range-selector label {
            font-weight: 500;
            color: #333;
        }

        .time-range-selector select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
            font-size: 14px;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #666 0%, #888 100%);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.2s;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
        }

        .statistics-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .charts-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        .chart-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .chart-header h3 {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .chart-legend {
            display: flex;
            gap: 20px;
        }

        .legend-item {
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .legend-item.income {
            color: #28a745;
        }

        .legend-item.expense {
            color: #dc3545;
        }

        .legend-item.balance {
            color: #007bff;
        }

        .chart-container {
            width: 100%;
            height: 400px;
        }

        .chart {
            width: 100%;
            height: 100%;
        }

        /* å“åº”å¼å›¾è¡¨ */
        @media (max-width: 768px) {
            .statistics-controls {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .statistics-overview {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 300px;
            }

            .chart-legend {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>

<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <header class="header">
        <div class="nav-container">
            <div class="logo">
                <span>ğŸ’°</span>
                <span>ç®¡å®¶å©†</span>
            </div>
            <div class="user-info">
                <div class="user-avatar">ğŸ‘¤</div>
                <span class="user-welcome"></span>
                <button class="logout-btn" onclick="logout()">é€€å‡º</button>
            </div>
        </div>
    </header>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="main-container">
        <!-- ä¾§è¾¹æ  -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">ğŸ“Š æ¦‚è§ˆ</div>
                <div class="menu-item" onclick="showPage('dashboard')">
                    <span>ğŸ“ˆ</span>
                    <span>å®¶åº­æ¦‚è§ˆ</span>
                </div>
                <div class="menu-item active" onclick="showPage('dashboard_one')">
                    <span>ğŸ“ˆ</span>
                    <span>ä¸ªäººæ•°æ®</span>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">ğŸ’° è´¢åŠ¡ç®¡ç†</div>
                <div class="menu-item" onclick="showPage('income')">
                    <span>ğŸ“ˆ</span>
                    <span>å®¶åº­æ”¶å…¥ç®¡ç†</span>
                </div>
                <div class="menu-item" onclick="showPage('expense')">
                    <span>ğŸ“‰</span>
                    <span>å®¶åº­æ”¯å‡ºç®¡ç†</span>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">ğŸ“Š ç»Ÿè®¡æŠ¥å‘Š</div>
                <div class="menu-item" onclick="showPage('statistics')">
                    <span>ğŸ“Š</span>
                    <span>æ•°æ®ç»Ÿè®¡</span>
                </div>
            </div>
        </aside>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="content" id="mainContent">
            <!-- 1.ä»ªè¡¨ç›˜é¡µé¢ -->
            <div id="dashboard-page" class="page-content" style="display: none;">
                <div class="myTitle">
                    <h1 class="page-title">å®¶åº­æ¦‚è§ˆ</h1>
                    <!-- å¿«é€Ÿæ“ä½œ -->
                    <div class="quick-actions">
                        <div class="budget-display" id="budgetDisplay" style="display: none;">
                            <span class="budget-label">æœ¬æœˆé¢„ç®—ï¼š</span>
                            <span class="budget-amount" id="budgetAmount">Â¥0</span>
                        </div>
                        <button class="action-btn" onclick="openModal('budget')">
                            <span><svg t="1757298903325" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="17408" width="20" height="20">
                                    <path
                                        d="M514.048 62.464q93.184 0 175.616 35.328t143.872 96.768 96.768 143.872 35.328 175.616q0 94.208-35.328 176.128t-96.768 143.36-143.872 96.768-175.616 35.328q-94.208 0-176.64-35.328t-143.872-96.768-96.768-143.36-35.328-176.128q0-93.184 35.328-175.616t96.768-143.872 143.872-96.768 176.64-35.328zM772.096 576.512q26.624 0 45.056-18.944t18.432-45.568-18.432-45.056-45.056-18.432l-192.512 0 0-192.512q0-26.624-18.944-45.568t-45.568-18.944-45.056 18.944-18.432 45.568l0 192.512-192.512 0q-26.624 0-45.056 18.432t-18.432 45.056 18.432 45.568 45.056 18.944l192.512 0 0 191.488q0 26.624 18.432 45.568t45.056 18.944 45.568-18.944 18.944-45.568l0-191.488 192.512 0z"
                                        p-id="17409" fill="#ffffff"></path>
                                </svg></span>
                            <span>è®¾ç½®é¢„ç®—</span>
                        </button>
                    </div>
                </div>

                <!-- æ¦‚è§ˆå¡ç‰‡ -->
                <div class="overview-cards">
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757297981248" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="8840" width="50" height="50">
                                <path
                                    d="M511.999488 94.669126c230.108818 0 417.317571 187.207729 417.317571 417.317571 0 230.124168-187.207729 417.344177-417.317571 417.344177-230.109842 0-417.317571-187.220009-417.317571-417.344177C94.681918 281.876855 281.889647 94.669126 511.999488 94.669126M511.999488 66.847477c-245.445108 0-445.138196 199.693088-445.138196 445.138196 0 245.417479 199.693088 445.164802 445.138196 445.164802s445.138196-199.747323 445.138196-445.164802C957.137685 266.540565 757.444597 66.847477 511.999488 66.847477L511.999488 66.847477z"
                                    p-id="8841"></path>
                                <path
                                    d="M429.623339 570.399061c8.639774-22.061458 22.442128-42.00365 40.644699-59.283198-117.261681-4.130064-208.658274-35.210943-208.658274-83.517135L261.609765 480.57836C261.608741 523.17962 332.683497 558.715975 429.623339 570.399061z"
                                    p-id="8842"></path>
                                <path
                                    d="M497.274112 260.780375c-130.141012 0-235.665371 42.166355-235.665371 94.167706l0 31.461549c0 52.001351 105.524358 94.167706 235.665371 94.167706 4.998851 0 9.726525-0.434905 14.671141-0.597611 34.885532-19.290345 77.159334-30.755468 122.80493-30.755468 10.866489 0 21.354354 1.249457 31.732725 2.553149 41.026392-16.953114 66.455551-39.937594 66.455551-65.3688l0-31.461549C732.93846 302.94673 627.414101 260.780375 497.274112 260.780375z"
                                    p-id="8843"></path>
                                <path
                                    d="M441.794543 698.147584c-103.243409-7.878434-180.185802-37.764092-180.185802-82.10395l0 53.033867c0 52.001351 105.524358 94.195336 235.665371 94.195336 4.455475 0 8.638751-0.434905 13.041014-0.543376C481.13555 746.236835 457.7704 723.959459 441.794543 698.147584z"
                                    p-id="8844"></path>
                                <path
                                    d="M425.982416 664.187121c-4.29277-13.58439-7.281847-27.603685-7.281847-42.275849 0-6.845918 1.575892-13.313214 2.554172-19.996426-92.64605-10.161431-159.646-38.742373-159.646-80.094176l0 52.978609C261.608741 616.859209 330.889641 652.014894 425.982416 664.187121z"
                                    p-id="8845"></path>
                                <path
                                    d="M643.715369 509.10609 599.15857 509.10609 599.15857 598.111217 510.152421 598.111217 510.152421 642.669038 599.15857 642.669038 599.15857 731.675188 643.715369 731.675188 643.715369 642.669038 732.721519 642.669038 732.721519 598.111217 643.715369 598.111217Z"
                                    p-id="8846"></path>
                            </svg></div>
                        <div class="card-title">æœ¬æœˆæ”¶å…¥</div>
                        <div class="card-value"></div>

                    </div>
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757297958556" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="7665" width="50" height="50">
                                <path
                                    d="M511.999488 94.682429c230.108818 0 417.317571 187.207729 417.317571 417.317571S742.108307 929.317571 511.999488 929.317571c-230.109842 0-417.317571-187.207729-417.317571-417.317571S281.889647 94.682429 511.999488 94.682429M511.999488 66.861804c-245.445108 0-445.138196 199.693088-445.138196 445.138196 0 245.445108 199.693088 445.138196 445.138196 445.138196s445.138196-199.694111 445.138196-445.138196C957.137685 266.553868 757.444597 66.861804 511.999488 66.861804L511.999488 66.861804z"
                                    p-id="7666"></path>
                                <path
                                    d="M415.059646 663.657049c-4.02057-13.530155-6.792707-27.495214-6.792707-42.111097 0-6.792707 1.468444-13.313214 2.337231-19.942191-86.451978-10.107195-148.996452-38.634926-148.996452-79.823l0 52.815903C261.608741 616.491843 326.326718 651.594315 415.059646 663.657049z"
                                    p-id="7667"></path>
                                <path
                                    d="M639.586328 451.90225c38.198997-16.844643 61.944817-39.775912 61.944817-65.097624l0-31.298843c0-51.838645-98.460476-93.89653-219.960691-93.89653-121.44598 0-219.960691 42.057885-219.960691 93.89653l0 31.298843c0 51.892881 98.514711 93.89653 219.960691 93.89653 4.673439 0 9.074679-0.434905 13.748119-0.651846 32.549324-19.23611 71.944566-30.646997 114.599038-30.646997C620.078019 449.402313 629.804545 450.706005 639.586328 451.90225z"
                                    p-id="7668"></path>
                                <path
                                    d="M418.429393 570.195424c8.04114-22.007223 20.973684-41.839921 37.926798-59.065234-109.436458-4.238534-194.748473-35.102473-194.748473-83.245959l0 52.816926C261.608741 523.084453 327.955822 558.567595 418.429393 570.195424z"
                                    p-id="7669"></path>
                                <path
                                    d="M435.925882 707.23659c-2.118244-3.151783-4.184299-6.466272-6.085602-9.726525-96.449679-7.879458-168.230516-37.60241-168.230516-81.833797l0 52.816926c0 13.855566 6.955412 26.951839 19.561521 38.742373 34.559097 32.494065 111.339808 55.153134 200.399169 55.153134 4.184299 0 8.096399-0.435928 12.172227-0.490164C469.995839 747.555877 450.435341 728.863143 435.925882 707.23659z"
                                    p-id="7670"></path>
                                <path d="M510.152421 603.505064l222.569098 0 0 44.556798-222.569098 0 0-44.556798Z"
                                    p-id="7671"></path>
                            </svg></div>
                        <div class="card-title">æœ¬æœˆæ”¯å‡º</div>
                        <div class="card-value"></div>

                    </div>
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757297681450" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="4571" width="40" height="40">
                                <path
                                    d="M711.06 390.34c-172 0-311.38 139.4-311.38 311.36 0 171.95 139.42 311.35 311.38 311.35 171.94 0 311.34-139.4 311.34-311.35 0-171.96-139.4-311.36-311.34-311.36z m69.48 269.26c5.22 0.96 10.22 1.45 14.63 1.45h47.3c4.5 0 8.44 1.7 11.72 5.62 3.32 3.78 4.92 7.4 4.92 11.19v34c0 6.76-4.76 9.89-13.84 9.89h-82c-3.62 0-7.09 0.96-10.46 2.98-3.28 1.76-4.74 4.72-4.74 8.35 0 3.95 0.08 7.74 0.56 11.97 0.48 4.28 0.67 7.9 0.67 10.54 0 5.64 4.88 7.65 13.98 5.64h80.7c9.26 0 13.84 4.25 13.84 12.85v31.27c0 9.26-6.74 14-19.62 14h-18.1c-7.24 0-14.72 0.32-22.76 0.64-7.72 0.65-15.12 0.8-21.56 0.8h-12.52c-8.12 0-12.38 4.76-12.38 14.31v56.53c0 4.9-3.79 7.23-11.18 7.23h-44.54c-11.98 0-18-5.15-18-15.51 0-3.95 0.34-11.9 0.74-24.3 0.62-12.2 0.3-20.65-0.68-25.4 0-4.66-0.54-7.79-1.44-9.24-0.8-1.36-3.46-2.02-8.28-2.02h-83.36c-12.04 0-18.08-6.1-18.08-18.48 0-2.66-0.26-6.27-1.3-10.69-0.98-4.1-0.98-8.45 0-13.35 1.04-4.66 2.42-8.92 4.2-12.86 1.92-3.62 5.54-5.06 11-4.1h93.02c1.92 0 2.72-2.33 2.72-7.24v-26.84c0-4.76-5.54-7.08-16.48-7.08h-80.54c-3.78 0-6.92-0.17-9.72-0.57-2.9-0.47-4.21-3.13-4.21-7.72v-17.28c0-7.4-0.46-13.03-1.38-16.96-1.9-5.63-0.46-10.37 4.04-13.98 4.68-3.96 10.76-5.64 18.08-5.64 7.48 0.96 15.6 1.14 24.52 0.65 8.68-0.5 15.52-0.65 20.1-0.65h16.48c5.56 0 7.48-2.01 5.56-5.63-1.78-2.08-7.32-9.16-16.48-21.22-9.42-12.62-19.06-25.17-29.18-38.35-12.08-16.15-26.06-33.61-41.74-52.42-6.44-10.36-5.06-18.97 4.2-25.4 4.56-2.89 9.4-6.43 14.46-10.85 5.14-4.18 11-8.2 17.52-11.9 9.16-5.7 17.92-0.58 26.28 15.43 2.9 3.95 8.14 10.69 16.08 20.67 7.88 10.04 16 20.32 24.2 31.82s16.16 21.56 23.64 30.32c7.48 9.08 11.5 14.63 12.62 16.48 1.76 3.78 5.14 6.1 10.2 7.08 5.16 0.96 8.78-0.65 10.54-4.27 0.82-2.01 4.66-7.79 11.76-17.84 6.9-9.73 14.62-20.75 22.9-33.13 8.36-12.29 16.22-23.72 23.56-34.81 7.56-10.77 12.14-17.69 13.98-20.43 4.6-6.66 8.68-10.84 11.66-12.7 3.3-1.91 8.6-1.35 16.16 1.38 4.58 1.84 9.74 4.66 15.04 8.35 5.7 3.87 9.48 6.77 11.16 8.69 10.22 10.46 13.1 19.38 8.38 26.78-1.78 2.98-6.94 10.04-15.14 21.38-8.66 11.25-17.44 23.22-27.18 36.1-9.88 12.7-18.46 24.6-26.36 36.1-7.86 11.32-12.22 18.09-13.32 19.77-2.51 4.65-1.53 7.47 3.45 8.6zM385 0C173.22 0 1.6 85.15 1.6 190.2c0 105.03 171.62 190.19 383.4 190.19 211.72 0 383.36-85.14 383.36-190.19S596.72 0 385 0z m120.82 429.19c-38.02 6.26-78.56 9.8-120.82 9.8-182.48 0-334.86-63.29-373.6-147.98-6.22 13.58-9.8 27.7-9.8 42.21 0 105.03 171.62 190.21 383.4 190.21 10.3 0 20.38-0.38 30.46-0.78 23.72-36.78 54.4-68.6 90.36-93.46z m252.02-52.4c6.64-13.98 10.48-28.53 10.48-43.54 0-14.54-3.56-28.63-9.8-42.21-13.76 30.11-42.16 57.46-80.96 80.28 5.48-0.27 10.82-0.85 16.34-0.85 21.88 0 43.26 2.26 63.94 6.32zM385 564.14c-182.48 0-334.86-63.29-373.6-147.99-6.22 13.59-9.8 27.7-9.8 42.21 0 102.05 162.14 185.09 365.54 189.75 4.86-29.56 13.54-57.81 25.68-84.16-2.6 0.04-5.2 0.19-7.82 0.19zM363.2 688.8c-172.66-4.81-314.6-66.22-351.8-147.51-6.22 13.6-9.8 27.7-9.8 42.22 0 102.62 163.98 186.04 369.02 189.82-5.1-23.1-7.98-47.03-7.98-71.66 0-4.32 0.38-8.56 0.56-12.87zM11.4 666.45c-6.22 13.59-9.8 27.68-9.8 42.2 0 105.03 171.62 190.21 383.4 190.21 14.26 0 28.26-0.45 42.1-1.21-18.52-25.22-33.38-53.29-44.24-83.28-181.52-0.5-332.88-63.57-371.46-147.92z m449.02 269.28c-24.42 2.43-49.56 3.84-75.42 3.84-182.48 0-334.86-63.29-373.6-147.99-6.22 13.59-9.8 27.71-9.8 42.22C1.6 938.84 173.22 1024 385 1024c62.42 0 121.18-7.55 173.28-20.69a329.602 329.602 0 0 1-97.86-67.58z m0 0"
                                    p-id="4572" fill="#707070"></path>
                            </svg></div>
                        <div class="card-title">æœ¬æœˆç»“ä½™</div>
                        <div class="card-value"></div>

                    </div>
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757298129812" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="10040" width="40" height="40">
                                <path
                                    d="M1023.988542 512.578635C1023.988542 231.385111 792.603431 0 511.409907 0h-2.016627l2.016627 512.578635z"
                                    p-id="10041" fill="#707070"></path>
                                <path
                                    d="M475.672056 69.917399C214.495854 70.662176 0 285.776768 0 546.95297c0 261.703275 215.343755 477.04703 477.035572 477.04703s477.035572-215.343755 477.035571-477.04703H477.035572z"
                                    p-id="10042" fill="#707070"></path>
                            </svg></div>
                        <div class="card-title">å‰©ä½™é¢„ç®—</div>
                        <div class="card-value"></div>
                    </div>
                </div>


                <!-- å®¶åº­æˆå‘˜ç®¡ç† -->
                <div class="family-members">
                    <div class="members-header">
                        <h3 class="members-title">å®¶åº­æˆå‘˜</h3>
                        <button class="invite-btn" onclick="inviteByUsername()">é‚€è¯·æˆå‘˜</button>
                    </div>
                    <div class="members-list"></div>
                </div>

                <!-- æœ€è¿‘äº¤æ˜“è®°å½• -->
                <div class="recent-transactions">
                    <!-- äº¤æ˜“è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>


            <!-- 2.ä¸ªäººä»ªè¡¨ç›˜é¡µé¢ -->
            <div id="dashboard_one-page" class="page-content">
                <div class="myTitle">
                    <h1 class="page-title">ä¸ªäººæ•°æ®</h1>
                    <div class="quick-actions">
                        <button class="action-btn" onclick="openModal('income')">
                            <span><svg t="1757298903325" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="17408" width="20" height="20">
                                    <path
                                        d="M514.048 62.464q93.184 0 175.616 35.328t143.872 96.768 96.768 143.872 35.328 175.616q0 94.208-35.328 176.128t-96.768 143.36-143.872 96.768-175.616 35.328q-94.208 0-176.64-35.328t-143.872-96.768-96.768-143.36-35.328-176.128q0-93.184 35.328-175.616t96.768-143.872 143.872-96.768 176.64-35.328zM772.096 576.512q26.624 0 45.056-18.944t18.432-45.568-18.432-45.056-45.056-18.432l-192.512 0 0-192.512q0-26.624-18.944-45.568t-45.568-18.944-45.056 18.944-18.432 45.568l0 192.512-192.512 0q-26.624 0-45.056 18.432t-18.432 45.056 18.432 45.568 45.056 18.944l192.512 0 0 191.488q0 26.624 18.432 45.568t45.056 18.944 45.568-18.944 18.944-45.568l0-191.488 192.512 0z"
                                        p-id="17409" fill="#ffffff"></path>
                                </svg></span>
                            <span>æ·»åŠ æ”¶å…¥</span>
                        </button>
                        <button class="action-btn" onclick="openModal('expense')">
                            <span><svg t="1757298903325" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="17408" width="20" height="20">
                                    <path
                                        d="M514.048 62.464q93.184 0 175.616 35.328t143.872 96.768 96.768 143.872 35.328 175.616q0 94.208-35.328 176.128t-96.768 143.36-143.872 96.768-175.616 35.328q-94.208 0-176.64-35.328t-143.872-96.768-96.768-143.36-35.328-176.128q0-93.184 35.328-175.616t96.768-143.872 143.872-96.768 176.64-35.328zM772.096 576.512q26.624 0 45.056-18.944t18.432-45.568-18.432-45.056-45.056-18.432l-192.512 0 0-192.512q0-26.624-18.944-45.568t-45.568-18.944-45.056 18.944-18.432 45.568l0 192.512-192.512 0q-26.624 0-45.056 18.432t-18.432 45.056 18.432 45.568 45.056 18.944l192.512 0 0 191.488q0 26.624 18.432 45.568t45.056 18.944 45.568-18.944 18.944-45.568l0-191.488 192.512 0z"
                                        p-id="17409" fill="#ffffff"></path>
                                </svg></span>
                            <span>æ·»åŠ æ”¯å‡º</span>
                        </button>
                    </div>
                </div>
                <!-- æ¦‚è§ˆå¡ç‰‡ -->
                <div class="overview-cards">
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757297981248" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="8840" width="50" height="50">
                                <path
                                    d="M511.999488 94.669126c230.108818 0 417.317571 187.207729 417.317571 417.317571 0 230.124168-187.207729 417.344177-417.317571 417.344177-230.109842 0-417.317571-187.220009-417.317571-417.344177C94.681918 281.876855 281.889647 94.669126 511.999488 94.669126M511.999488 66.847477c-245.445108 0-445.138196 199.693088-445.138196 445.138196 0 245.417479 199.693088 445.164802 445.138196 445.164802s445.138196-199.747323 445.138196-445.164802C957.137685 266.540565 757.444597 66.847477 511.999488 66.847477L511.999488 66.847477z"
                                    p-id="8841"></path>
                                <path
                                    d="M429.623339 570.399061c8.639774-22.061458 22.442128-42.00365 40.644699-59.283198-117.261681-4.130064-208.658274-35.210943-208.658274-83.517135L261.609765 480.57836C261.608741 523.17962 332.683497 558.715975 429.623339 570.399061z"
                                    p-id="8842"></path>
                                <path
                                    d="M497.274112 260.780375c-130.141012 0-235.665371 42.166355-235.665371 94.167706l0 31.461549c0 52.001351 105.524358 94.167706 235.665371 94.167706 4.998851 0 9.726525-0.434905 14.671141-0.597611 34.885532-19.290345 77.159334-30.755468 122.80493-30.755468 10.866489 0 21.354354 1.249457 31.732725 2.553149 41.026392-16.953114 66.455551-39.937594 66.455551-65.3688l0-31.461549C732.93846 302.94673 627.414101 260.780375 497.274112 260.780375z"
                                    p-id="8843"></path>
                                <path
                                    d="M441.794543 698.147584c-103.243409-7.878434-180.185802-37.764092-180.185802-82.10395l0 53.033867c0 52.001351 105.524358 94.195336 235.665371 94.195336 4.455475 0 8.638751-0.434905 13.041014-0.543376C481.13555 746.236835 457.7704 723.959459 441.794543 698.147584z"
                                    p-id="8844"></path>
                                <path
                                    d="M425.982416 664.187121c-4.29277-13.58439-7.281847-27.603685-7.281847-42.275849 0-6.845918 1.575892-13.313214 2.554172-19.996426-92.64605-10.161431-159.646-38.742373-159.646-80.094176l0 52.978609C261.608741 616.859209 330.889641 652.014894 425.982416 664.187121z"
                                    p-id="8845"></path>
                                <path
                                    d="M643.715369 509.10609 599.15857 509.10609 599.15857 598.111217 510.152421 598.111217 510.152421 642.669038 599.15857 642.669038 599.15857 731.675188 643.715369 731.675188 643.715369 642.669038 732.721519 642.669038 732.721519 598.111217 643.715369 598.111217Z"
                                    p-id="8846"></path>
                            </svg></div>
                        <div class="card-title">æœ¬æœˆæ”¶å…¥</div>
                        <div class="card-value"></div>

                    </div>
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757297958556" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="7665" width="50" height="50">
                                <path
                                    d="M511.999488 94.682429c230.108818 0 417.317571 187.207729 417.317571 417.317571S742.108307 929.317571 511.999488 929.317571c-230.109842 0-417.317571-187.207729-417.317571-417.317571S281.889647 94.682429 511.999488 94.682429M511.999488 66.861804c-245.445108 0-445.138196 199.693088-445.138196 445.138196 0 245.445108 199.693088 445.138196 445.138196 445.138196s445.138196-199.694111 445.138196-445.138196C957.137685 266.553868 757.444597 66.861804 511.999488 66.861804L511.999488 66.861804z"
                                    p-id="7666"></path>
                                <path
                                    d="M415.059646 663.657049c-4.02057-13.530155-6.792707-27.495214-6.792707-42.111097 0-6.792707 1.468444-13.313214 2.337231-19.942191-86.451978-10.107195-148.996452-38.634926-148.996452-79.823l0 52.815903C261.608741 616.491843 326.326718 651.594315 415.059646 663.657049z"
                                    p-id="7667"></path>
                                <path
                                    d="M639.586328 451.90225c38.198997-16.844643 61.944817-39.775912 61.944817-65.097624l0-31.298843c0-51.838645-98.460476-93.89653-219.960691-93.89653-121.44598 0-219.960691 42.057885-219.960691 93.89653l0 31.298843c0 51.892881 98.514711 93.89653 219.960691 93.89653 4.673439 0 9.074679-0.434905 13.748119-0.651846 32.549324-19.23611 71.944566-30.646997 114.599038-30.646997C620.078019 449.402313 629.804545 450.706005 639.586328 451.90225z"
                                    p-id="7668"></path>
                                <path
                                    d="M418.429393 570.195424c8.04114-22.007223 20.973684-41.839921 37.926798-59.065234-109.436458-4.238534-194.748473-35.102473-194.748473-83.245959l0 52.816926C261.608741 523.084453 327.955822 558.567595 418.429393 570.195424z"
                                    p-id="7669"></path>
                                <path
                                    d="M435.925882 707.23659c-2.118244-3.151783-4.184299-6.466272-6.085602-9.726525-96.449679-7.879458-168.230516-37.60241-168.230516-81.833797l0 52.816926c0 13.855566 6.955412 26.951839 19.561521 38.742373 34.559097 32.494065 111.339808 55.153134 200.399169 55.153134 4.184299 0 8.096399-0.435928 12.172227-0.490164C469.995839 747.555877 450.435341 728.863143 435.925882 707.23659z"
                                    p-id="7670"></path>
                                <path d="M510.152421 603.505064l222.569098 0 0 44.556798-222.569098 0 0-44.556798Z"
                                    p-id="7671"></path>
                            </svg></div>
                        <div class="card-title">æœ¬æœˆæ”¯å‡º</div>
                        <div class="card-value"></div>

                    </div>
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757297681450" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="4571" width="40" height="40">
                                <path
                                    d="M711.06 390.34c-172 0-311.38 139.4-311.38 311.36 0 171.95 139.42 311.35 311.38 311.35 171.94 0 311.34-139.4 311.34-311.35 0-171.96-139.4-311.36-311.34-311.36z m69.48 269.26c5.22 0.96 10.22 1.45 14.63 1.45h47.3c4.5 0 8.44 1.7 11.72 5.62 3.32 3.78 4.92 7.4 4.92 11.19v34c0 6.76-4.76 9.89-13.84 9.89h-82c-3.62 0-7.09 0.96-10.46 2.98-3.28 1.76-4.74 4.72-4.74 8.35 0 3.95 0.08 7.74 0.56 11.97 0.48 4.28 0.67 7.9 0.67 10.54 0 5.64 4.88 7.65 13.98 5.64h80.7c9.26 0 13.84 4.25 13.84 12.85v31.27c0 9.26-6.74 14-19.62 14h-18.1c-7.24 0-14.72 0.32-22.76 0.64-7.72 0.65-15.12 0.8-21.56 0.8h-12.52c-8.12 0-12.38 4.76-12.38 14.31v56.53c0 4.9-3.79 7.23-11.18 7.23h-44.54c-11.98 0-18-5.15-18-15.51 0-3.95 0.34-11.9 0.74-24.3 0.62-12.2 0.3-20.65-0.68-25.4 0-4.66-0.54-7.79-1.44-9.24-0.8-1.36-3.46-2.02-8.28-2.02h-83.36c-12.04 0-18.08-6.1-18.08-18.48 0-2.66-0.26-6.27-1.3-10.69-0.98-4.1-0.98-8.45 0-13.35 1.04-4.66 2.42-8.92 4.2-12.86 1.92-3.62 5.54-5.06 11-4.1h93.02c1.92 0 2.72-2.33 2.72-7.24v-26.84c0-4.76-5.54-7.08-16.48-7.08h-80.54c-3.78 0-6.92-0.17-9.72-0.57-2.9-0.47-4.21-3.13-4.21-7.72v-17.28c0-7.4-0.46-13.03-1.38-16.96-1.9-5.63-0.46-10.37 4.04-13.98 4.68-3.96 10.76-5.64 18.08-5.64 7.48 0.96 15.6 1.14 24.52 0.65 8.68-0.5 15.52-0.65 20.1-0.65h16.48c5.56 0 7.48-2.01 5.56-5.63-1.78-2.08-7.32-9.16-16.48-21.22-9.42-12.62-19.06-25.17-29.18-38.35-12.08-16.15-26.06-33.61-41.74-52.42-6.44-10.36-5.06-18.97 4.2-25.4 4.56-2.89 9.4-6.43 14.46-10.85 5.14-4.18 11-8.2 17.52-11.9 9.16-5.7 17.92-0.58 26.28 15.43 2.9 3.95 8.14 10.69 16.08 20.67 7.88 10.04 16 20.32 24.2 31.82s16.16 21.56 23.64 30.32c7.48 9.08 11.5 14.63 12.62 16.48 1.76 3.78 5.14 6.1 10.2 7.08 5.16 0.96 8.78-0.65 10.54-4.27 0.82-2.01 4.66-7.79 11.76-17.84 6.9-9.73 14.62-20.75 22.9-33.13 8.36-12.29 16.22-23.72 23.56-34.81 7.56-10.77 12.14-17.69 13.98-20.43 4.6-6.66 8.68-10.84 11.66-12.7 3.3-1.91 8.6-1.35 16.16 1.38 4.58 1.84 9.74 4.66 15.04 8.35 5.7 3.87 9.48 6.77 11.16 8.69 10.22 10.46 13.1 19.38 8.38 26.78-1.78 2.98-6.94 10.04-15.14 21.38-8.66 11.25-17.44 23.22-27.18 36.1-9.88 12.7-18.46 24.6-26.36 36.1-7.86 11.32-12.22 18.09-13.32 19.77-2.51 4.65-1.53 7.47 3.45 8.6zM385 0C173.22 0 1.6 85.15 1.6 190.2c0 105.03 171.62 190.19 383.4 190.19 211.72 0 383.36-85.14 383.36-190.19S596.72 0 385 0z m120.82 429.19c-38.02 6.26-78.56 9.8-120.82 9.8-182.48 0-334.86-63.29-373.6-147.98-6.22 13.58-9.8 27.7-9.8 42.21 0 105.03 171.62 190.21 383.4 190.21 10.3 0 20.38-0.38 30.46-0.78 23.72-36.78 54.4-68.6 90.36-93.46z m252.02-52.4c6.64-13.98 10.48-28.53 10.48-43.54 0-14.54-3.56-28.63-9.8-42.21-13.76 30.11-42.16 57.46-80.96 80.28 5.48-0.27 10.82-0.85 16.34-0.85 21.88 0 43.26 2.26 63.94 6.32zM385 564.14c-182.48 0-334.86-63.29-373.6-147.99-6.22 13.59-9.8 27.7-9.8 42.21 0 102.05 162.14 185.09 365.54 189.75 4.86-29.56 13.54-57.81 25.68-84.16-2.6 0.04-5.2 0.19-7.82 0.19zM363.2 688.8c-172.66-4.81-314.6-66.22-351.8-147.51-6.22 13.6-9.8 27.7-9.8 42.22 0 102.62 163.98 186.04 369.02 189.82-5.1-23.1-7.98-47.03-7.98-71.66 0-4.32 0.38-8.56 0.56-12.87zM11.4 666.45c-6.22 13.59-9.8 27.68-9.8 42.2 0 105.03 171.62 190.21 383.4 190.21 14.26 0 28.26-0.45 42.1-1.21-18.52-25.22-33.38-53.29-44.24-83.28-181.52-0.5-332.88-63.57-371.46-147.92z m449.02 269.28c-24.42 2.43-49.56 3.84-75.42 3.84-182.48 0-334.86-63.29-373.6-147.99-6.22 13.59-9.8 27.71-9.8 42.22C1.6 938.84 173.22 1024 385 1024c62.42 0 121.18-7.55 173.28-20.69a329.602 329.602 0 0 1-97.86-67.58z m0 0"
                                    p-id="4572" fill="#707070"></path>
                            </svg></div>
                        <div class="card-title">æœ¬æœˆç»“ä½™</div>
                        <div class="card-value"></div>

                    </div>

                </div>


                <!-- æœ€è¿‘äº¤æ˜“è®°å½• -->
                <div class="recent-transactions">
                    <!-- äº¤æ˜“è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>


            <!-- 3.æ”¶å…¥ç®¡ç†é¡µé¢ -->
            <div id="income-page" class="page-content" style="display: none;">
                <div class="myTitle">
                    <h1 class="page-title">æ”¶å…¥ç®¡ç†</h1>
                    <div class="quick-actions">
                        <button class="action-btn" onclick="openModal('income')">
                            <span><svg t="1757298903325" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="17408" width="20" height="20">
                                    <path
                                        d="M514.048 62.464q93.184 0 175.616 35.328t143.872 96.768 96.768 143.872 35.328 175.616q0 94.208-35.328 176.128t-96.768 143.36-143.872 96.768-175.616 35.328q-94.208 0-176.64-35.328t-143.872-96.768-96.768-143.36-35.328-176.128q0-93.184 35.328-175.616t96.768-143.872 143.872-96.768 176.64-35.328zM772.096 576.512q26.624 0 45.056-18.944t18.432-45.568-18.432-45.056-45.056-18.432l-192.512 0 0-192.512q0-26.624-18.944-45.568t-45.568-18.944-45.056 18.944-18.432 45.568l0 192.512-192.512 0q-26.624 0-45.056 18.432t-18.432 45.056 18.432 45.568 45.056 18.944l192.512 0 0 191.488q0 26.624 18.432 45.568t45.056 18.944 45.568-18.944 18.944-45.568l0-191.488 192.512 0z"
                                        p-id="17409" fill="#ffffff"></path>
                                </svg></span>
                            <span>æ·»åŠ æ”¶å…¥</span>
                        </button>
                    </div>
                </div>

                <div class="overview-cards">
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757297981248" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="8840" width="40" height="40">
                                <path
                                    d="M511.999488 94.669126c230.108818 0 417.317571 187.207729 417.317571 417.317571 0 230.124168-187.207729 417.344177-417.317571 417.344177-230.109842 0-417.317571-187.220009-417.317571-417.344177C94.681918 281.876855 281.889647 94.669126 511.999488 94.669126M511.999488 66.847477c-245.445108 0-445.138196 199.693088-445.138196 445.138196 0 245.417479 199.693088 445.164802 445.138196 445.164802s445.138196-199.747323 445.138196-445.164802C957.137685 266.540565 757.444597 66.847477 511.999488 66.847477L511.999488 66.847477z"
                                    p-id="8841"></path>
                                <path
                                    d="M429.623339 570.399061c8.639774-22.061458 22.442128-42.00365 40.644699-59.283198-117.261681-4.130064-208.658274-35.210943-208.658274-83.517135L261.609765 480.57836C261.608741 523.17962 332.683497 558.715975 429.623339 570.399061z"
                                    p-id="8842"></path>
                                <path
                                    d="M497.274112 260.780375c-130.141012 0-235.665371 42.166355-235.665371 94.167706l0 31.461549c0 52.001351 105.524358 94.167706 235.665371 94.167706 4.998851 0 9.726525-0.434905 14.671141-0.597611 34.885532-19.290345 77.159334-30.755468 122.80493-30.755468 10.866489 0 21.354354 1.249457 31.732725 2.553149 41.026392-16.953114 66.455551-39.937594 66.455551-65.3688l0-31.461549C732.93846 302.94673 627.414101 260.780375 497.274112 260.780375z"
                                    p-id="8843"></path>
                                <path
                                    d="M441.794543 698.147584c-103.243409-7.878434-180.185802-37.764092-180.185802-82.10395l0 53.033867c0 52.001351 105.524358 94.195336 235.665371 94.195336 4.455475 0 8.638751-0.434905 13.041014-0.543376C481.13555 746.236835 457.7704 723.959459 441.794543 698.147584z"
                                    p-id="8844"></path>
                                <path
                                    d="M425.982416 664.187121c-4.29277-13.58439-7.281847-27.603685-7.281847-42.275849 0-6.845918 1.575892-13.313214 2.554172-19.996426-92.64605-10.161431-159.646-38.742373-159.646-80.094176l0 52.978609C261.608741 616.859209 330.889641 652.014894 425.982416 664.187121z"
                                    p-id="8845"></path>
                                <path
                                    d="M643.715369 509.10609 599.15857 509.10609 599.15857 598.111217 510.152421 598.111217 510.152421 642.669038 599.15857 642.669038 599.15857 731.675188 643.715369 731.675188 643.715369 642.669038 732.721519 642.669038 732.721519 598.111217 643.715369 598.111217Z"
                                    p-id="8846"></path>
                            </svg></div>
                        <div class="card-title">æœ¬æœˆæ”¶å…¥</div>
                        <div class="card-value"></div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757298481960" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="15447" width="40" height="40">
                                <path
                                    d="M819.2 407.373913V198.121739v-4.452174c-8.904348-84.591304-153.6-146.921739-345.043478-146.921739-195.895652 0-345.043478 66.782609-345.043479 155.826087V333.913043c-60.104348 13.356522-122.434783 40.069565-126.886956 82.365218v153.6c0 22.26087 13.356522 42.295652 33.391304 53.426087 4.452174 2.226087 11.130435 4.452174 17.808696 8.904348-2.226087 2.226087-2.226087 6.678261-2.226087 8.904347 0 2.226087-2.226087 4.452174-2.226087 6.678261v149.147826c0 22.26087 13.356522 42.295652 35.617391 53.426087 44.521739 20.034783 155.826087 64.556522 293.843479 64.556522 20.034783 0 37.843478 0 57.87826-2.226087 2.226087 0 40.069565-2.226087 86.817392-8.904348 2.226087 0 2.226087 0 4.452174-2.226087 53.426087 51.2 124.66087 84.591304 204.8 84.591305C892.66087 979.478261 1024 848.13913 1024 687.86087c0-131.33913-86.817391-242.643478-204.8-280.486957z m-89.043478-13.356522c-60.104348 0-115.756522 17.808696-164.730435 48.973913-42.295652 6.678261-75.686957 8.904348-75.686957 8.904348-144.695652 13.356522-264.904348-35.617391-309.426087-57.878261-6.678261-2.226087-8.904348-8.904348-8.904347-15.582608v-24.486957-75.686956c57.878261 48.973913 169.182609 80.13913 302.747826 80.13913s244.869565-31.165217 302.747826-77.913043v117.982608c-15.582609-4.452174-31.165217-4.452174-46.747826-4.452174zM474.156522 89.043478c178.086957 0 302.747826 60.104348 302.747826 113.530435 0 53.426087-124.66087 113.530435-302.747826 113.530435S171.408696 256 171.408696 202.573913C171.408696 149.147826 296.069565 89.043478 474.156522 89.043478zM129.113043 376.208696v2.226087c0 22.26087 13.356522 42.295652 33.391305 53.426087 33.391304 15.582609 106.852174 46.747826 198.121739 57.87826h-13.356522C158.052174 489.73913 44.521739 445.217391 44.521739 420.730435c-2.226087-6.678261 20.034783-26.713043 84.591304-44.521739z m-86.817391 193.669565v-91.269565c62.330435 37.843478 186.991304 55.652174 302.747826 55.652174 48.973913 0 95.721739-2.226087 138.017392-8.904348-22.26087 31.165217-35.617391 69.008696-44.52174 109.078261h-2.226087c-42.295652 6.678261-75.686957 8.904348-77.913043 8.904347-144.695652 13.356522-264.904348-35.617391-309.426087-57.87826-2.226087-4.452174-6.678261-8.904348-6.678261-15.582609zM89.043478 645.565217c53.426087 20.034783 131.33913 40.069565 220.382609 40.069566 17.808696 0 35.617391 0 55.652174-2.226087 2.226087 0 31.165217-2.226087 71.234782-6.678261v11.130435c0 8.904348 0 20.034783 2.226087 28.93913h-22.260869C200.347826 716.8 89.043478 667.826087 89.043478 645.565217z m342.817392 220.382609c-153.6 13.356522-282.713043-35.617391-331.686957-57.878261-6.678261-2.226087-11.130435-8.904348-11.130435-13.356522v-93.495652c64.556522 37.843478 198.121739 55.652174 325.008696 55.652174H445.217391c8.904348 37.843478 26.713043 73.46087 48.973913 102.4-35.617391 6.678261-62.330435 6.678261-62.330434 6.678261z m298.295652 73.46087c-138.017391 0-251.547826-113.530435-251.547826-251.547826 0-138.017391 113.530435-251.547826 251.547826-251.547827s251.547826 113.530435 251.547826 251.547827c0 138.017391-113.530435 251.547826-251.547826 251.547826z"
                                    p-id="15448"></path>
                                <path
                                    d="M632.208696 585.46087c-6.678261 11.130435-13.356522 20.034783-22.26087 31.165217-6.678261 8.904348-15.582609 17.808696-22.260869 26.713043l-22.26087-15.582608c6.678261-6.678261 13.356522-15.582609 22.26087-24.486957 6.678261-8.904348 13.356522-17.808696 17.808695-26.713043 6.678261-8.904348 11.130435-17.808696 15.582609-26.713044 4.452174-8.904348 8.904348-17.808696 11.130435-24.486956l24.486956 8.904348-6.678261 13.356521-6.678261 13.356522h77.913044v22.26087H667.826087c2.226087 6.678261 6.678261 13.356522 8.904348 20.034782 2.226087 6.678261 6.678261 13.356522 8.904348 17.808696l-22.26087 11.130435c-2.226087-4.452174-2.226087-6.678261-4.452174-11.130435l-6.678261-13.356522-6.678261-13.356522c-2.226087-4.452174-4.452174-6.678261-4.452174-11.130434h-8.904347z m200.347826 218.156521c0-2.226087 2.226087-6.678261 2.226087-11.130434s2.226087-8.904348 2.226087-13.356522l26.713043 8.904348c0 6.678261-2.226087 15.582609-4.452174 24.486956-2.226087 6.678261-2.226087 11.130435-4.452174 13.356522-2.226087 4.452174-4.452174 6.678261-6.678261 8.904348-2.226087 2.226087-6.678261 4.452174-11.130434 4.452174s-11.130435 2.226087-20.034783 2.226087h-77.913043c-8.904348 0-15.582609 0-20.034783-2.226087-6.678261-2.226087-11.130435-4.452174-13.356522-6.678261-4.452174-2.226087-6.678261-6.678261-8.904348-13.356522-2.226087-4.452174-2.226087-11.130435-2.226087-20.034783v-26.713043l-120.208695 6.678261v-22.26087l120.208695-6.678261v-33.391304l-97.947826 4.452174v-22.26087l97.947826-4.452174v-28.93913c-15.582609 2.226087-33.391304 2.226087-48.973913 2.226087-15.582609 0-33.391304 2.226087-48.973913 2.226087l-2.226087-22.26087c20.034783 0 42.295652-2.226087 64.556522-4.452174s42.295652-2.226087 64.556522-4.452173c20.034783-2.226087 42.295652-4.452174 60.104348-6.678261 20.034783-2.226087 37.843478-4.452174 55.652174-6.678261l4.452174 22.260869c-17.808696 2.226087-35.617391 4.452174-55.652174 6.678261s-42.295652 4.452174-62.330435 6.678261V690.086957l115.756522-6.678261v22.260869l-117.982609 6.678261v33.391304l153.6-8.904347v22.260869l-153.6 8.904348V801.391304c0 2.226087 2.226087 4.452174 4.452174 6.678261 2.226087 2.226087 4.452174 2.226087 8.904348 4.452174 2.226087 0 6.678261 2.226087 13.356521 2.226087H823.652174c2.226087 0 4.452174-2.226087 6.678261-2.226087l4.452174-4.452174c-2.226087 0-2.226087-2.226087-2.226087-4.452174z m-122.434783-178.086956c11.130435-15.582609 22.26087-31.165217 31.165218-48.973913 8.904348-17.808696 15.582609-33.391304 22.260869-48.973913l24.486957 8.904348c-2.226087 4.452174-4.452174 8.904348-4.452174 13.356521-2.226087 4.452174-4.452174 8.904348-4.452174 13.356522h95.721739v22.26087h-60.104348c4.452174 4.452174 6.678261 11.130435 11.130435 15.582608 4.452174 4.452174 6.678261 8.904348 8.904348 13.356522l-17.808696 13.356522c-2.226087-2.226087-4.452174-6.678261-6.678261-8.904348-2.226087-4.452174-4.452174-6.678261-6.678261-11.130435-2.226087-4.452174-4.452174-6.678261-6.678261-11.130435-2.226087-4.452174-4.452174-6.678261-6.67826-8.904347h-17.808696l-13.356522 26.713043c-4.452174 8.904348-11.130435 15.582609-15.582609 24.486957l-33.391304-13.356522z"
                                    p-id="15449"></path>
                            </svg></div>
                        <div class="card-title">æ”¶å…¥ç¬”æ•°</div>
                        <div class="card-value"></div>
                    </div>
                </div>

                <!-- æˆå‘˜æ”¶å…¥åˆ—è¡¨ -->
                <div class="members-income-section">
                    <h3>æˆå‘˜æ”¶å…¥æ˜ç»†</h3>
                    <div class="members-income-list">
                        <!-- æˆå‘˜æ”¶å…¥å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <div class="recent-transactions">
                    <!-- æ”¶å…¥è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- 4.æ”¯å‡ºç®¡ç†é¡µé¢ -->
            <div id="expense-page" class="page-content" style="display: none;">
                <div class="myTitle">
                    <h1 class="page-title">æ”¯å‡ºç®¡ç†</h1>
                    <div class="quick-actions">
                        <button class="action-btn" onclick="openModal('expense')">
                            <span><svg t="1757298903325" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="17408" width="20" height="20">
                                    <path
                                        d="M514.048 62.464q93.184 0 175.616 35.328t143.872 96.768 96.768 143.872 35.328 175.616q0 94.208-35.328 176.128t-96.768 143.36-143.872 96.768-175.616 35.328q-94.208 0-176.64-35.328t-143.872-96.768-96.768-143.36-35.328-176.128q0-93.184 35.328-175.616t96.768-143.872 143.872-96.768 176.64-35.328zM772.096 576.512q26.624 0 45.056-18.944t18.432-45.568-18.432-45.056-45.056-18.432l-192.512 0 0-192.512q0-26.624-18.944-45.568t-45.568-18.944-45.056 18.944-18.432 45.568l0 192.512-192.512 0q-26.624 0-45.056 18.432t-18.432 45.056 18.432 45.568 45.056 18.944l192.512 0 0 191.488q0 26.624 18.432 45.568t45.056 18.944 45.568-18.944 18.944-45.568l0-191.488 192.512 0z"
                                        p-id="17409" fill="#ffffff"></path>
                                </svg></span>
                            <span>æ·»åŠ æ”¯å‡º</span>
                        </button>
                    </div>
                </div>

                <div class="overview-cards">
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757297958556" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="7665" width="40" height="40">
                                <path
                                    d="M511.999488 94.682429c230.108818 0 417.317571 187.207729 417.317571 417.317571S742.108307 929.317571 511.999488 929.317571c-230.109842 0-417.317571-187.207729-417.317571-417.317571S281.889647 94.682429 511.999488 94.682429M511.999488 66.861804c-245.445108 0-445.138196 199.693088-445.138196 445.138196 0 245.445108 199.693088 445.138196 445.138196 445.138196s445.138196-199.694111 445.138196-445.138196C957.137685 266.553868 757.444597 66.861804 511.999488 66.861804L511.999488 66.861804z"
                                    p-id="7666"></path>
                                <path
                                    d="M415.059646 663.657049c-4.02057-13.530155-6.792707-27.495214-6.792707-42.111097 0-6.792707 1.468444-13.313214 2.337231-19.942191-86.451978-10.107195-148.996452-38.634926-148.996452-79.823l0 52.815903C261.608741 616.491843 326.326718 651.594315 415.059646 663.657049z"
                                    p-id="7667"></path>
                                <path
                                    d="M639.586328 451.90225c38.198997-16.844643 61.944817-39.775912 61.944817-65.097624l0-31.298843c0-51.838645-98.460476-93.89653-219.960691-93.89653-121.44598 0-219.960691 42.057885-219.960691 93.89653l0 31.298843c0 51.892881 98.514711 93.89653 219.960691 93.89653 4.673439 0 9.074679-0.434905 13.748119-0.651846 32.549324-19.23611 71.944566-30.646997 114.599038-30.646997C620.078019 449.402313 629.804545 450.706005 639.586328 451.90225z"
                                    p-id="7668"></path>
                                <path
                                    d="M418.429393 570.195424c8.04114-22.007223 20.973684-41.839921 37.926798-59.065234-109.436458-4.238534-194.748473-35.102473-194.748473-83.245959l0 52.816926C261.608741 523.084453 327.955822 558.567595 418.429393 570.195424z"
                                    p-id="7669"></path>
                                <path
                                    d="M435.925882 707.23659c-2.118244-3.151783-4.184299-6.466272-6.085602-9.726525-96.449679-7.879458-168.230516-37.60241-168.230516-81.833797l0 52.816926c0 13.855566 6.955412 26.951839 19.561521 38.742373 34.559097 32.494065 111.339808 55.153134 200.399169 55.153134 4.184299 0 8.096399-0.435928 12.172227-0.490164C469.995839 747.555877 450.435341 728.863143 435.925882 707.23659z"
                                    p-id="7670"></path>
                                <path d="M510.152421 603.505064l222.569098 0 0 44.556798-222.569098 0 0-44.556798Z"
                                    p-id="7671"></path>
                            </svg></div>
                        <div class="card-title">æœ¬æœˆæ”¯å‡º</div>
                        <div class="card-value"></div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon"><svg t="1757298481960" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="15447" width="40" height="40">
                                <path
                                    d="M819.2 407.373913V198.121739v-4.452174c-8.904348-84.591304-153.6-146.921739-345.043478-146.921739-195.895652 0-345.043478 66.782609-345.043479 155.826087V333.913043c-60.104348 13.356522-122.434783 40.069565-126.886956 82.365218v153.6c0 22.26087 13.356522 42.295652 33.391304 53.426087 4.452174 2.226087 11.130435 4.452174 17.808696 8.904348-2.226087 2.226087-2.226087 6.678261-2.226087 8.904347 0 2.226087-2.226087 4.452174-2.226087 6.678261v149.147826c0 22.26087 13.356522 42.295652 35.617391 53.426087 44.521739 20.034783 155.826087 64.556522 293.843479 64.556522 20.034783 0 37.843478 0 57.87826-2.226087 2.226087 0 40.069565-2.226087 86.817392-8.904348 2.226087 0 2.226087 0 4.452174-2.226087 53.426087 51.2 124.66087 84.591304 204.8 84.591305C892.66087 979.478261 1024 848.13913 1024 687.86087c0-131.33913-86.817391-242.643478-204.8-280.486957z m-89.043478-13.356522c-60.104348 0-115.756522 17.808696-164.730435 48.973913-42.295652 6.678261-75.686957 8.904348-75.686957 8.904348-144.695652 13.356522-264.904348-35.617391-309.426087-57.878261-6.678261-2.226087-8.904348-8.904348-8.904347-15.582608v-24.486957-75.686956c57.878261 48.973913 169.182609 80.13913 302.747826 80.13913s244.869565-31.165217 302.747826-77.913043v117.982608c-15.582609-4.452174-31.165217-4.452174-46.747826-4.452174zM474.156522 89.043478c178.086957 0 302.747826 60.104348 302.747826 113.530435 0 53.426087-124.66087 113.530435-302.747826 113.530435S171.408696 256 171.408696 202.573913C171.408696 149.147826 296.069565 89.043478 474.156522 89.043478zM129.113043 376.208696v2.226087c0 22.26087 13.356522 42.295652 33.391305 53.426087 33.391304 15.582609 106.852174 46.747826 198.121739 57.87826h-13.356522C158.052174 489.73913 44.521739 445.217391 44.521739 420.730435c-2.226087-6.678261 20.034783-26.713043 84.591304-44.521739z m-86.817391 193.669565v-91.269565c62.330435 37.843478 186.991304 55.652174 302.747826 55.652174 48.973913 0 95.721739-2.226087 138.017392-8.904348-22.26087 31.165217-35.617391 69.008696-44.52174 109.078261h-2.226087c-42.295652 6.678261-75.686957 8.904348-77.913043 8.904347-144.695652 13.356522-264.904348-35.617391-309.426087-57.87826-2.226087-4.452174-6.678261-8.904348-6.678261-15.582609zM89.043478 645.565217c53.426087 20.034783 131.33913 40.069565 220.382609 40.069566 17.808696 0 35.617391 0 55.652174-2.226087 2.226087 0 31.165217-2.226087 71.234782-6.678261v11.130435c0 8.904348 0 20.034783 2.226087 28.93913h-22.260869C200.347826 716.8 89.043478 667.826087 89.043478 645.565217z m342.817392 220.382609c-153.6 13.356522-282.713043-35.617391-331.686957-57.878261-6.678261-2.226087-11.130435-8.904348-11.130435-13.356522v-93.495652c64.556522 37.843478 198.121739 55.652174 325.008696 55.652174H445.217391c8.904348 37.843478 26.713043 73.46087 48.973913 102.4-35.617391 6.678261-62.330435 6.678261-62.330434 6.678261z m298.295652 73.46087c-138.017391 0-251.547826-113.530435-251.547826-251.547826 0-138.017391 113.530435-251.547826 251.547826-251.547827s251.547826 113.530435 251.547826 251.547827c0 138.017391-113.530435 251.547826-251.547826 251.547826z"
                                    p-id="15448"></path>
                                <path
                                    d="M632.208696 585.46087c-6.678261 11.130435-13.356522 20.034783-22.26087 31.165217-6.678261 8.904348-15.582609 17.808696-22.260869 26.713043l-22.26087-15.582608c6.678261-6.678261 13.356522-15.582609 22.26087-24.486957 6.678261-8.904348 13.356522-17.808696 17.808695-26.713043 6.678261-8.904348 11.130435-17.808696 15.582609-26.713044 4.452174-8.904348 8.904348-17.808696 11.130435-24.486956l24.486956 8.904348-6.678261 13.356521-6.678261 13.356522h77.913044v22.26087H667.826087c2.226087 6.678261 6.678261 13.356522 8.904348 20.034782 2.226087 6.678261 6.678261 13.356522 8.904348 17.808696l-22.26087 11.130435c-2.226087-4.452174-2.226087-6.678261-4.452174-11.130435l-6.678261-13.356522-6.678261-13.356522c-2.226087-4.452174-4.452174-6.678261-4.452174-11.130434h-8.904347z m200.347826 218.156521c0-2.226087 2.226087-6.678261 2.226087-11.130434s2.226087-8.904348 2.226087-13.356522l26.713043 8.904348c0 6.678261-2.226087 15.582609-4.452174 24.486956-2.226087 6.678261-2.226087 11.130435-4.452174 13.356522-2.226087 4.452174-4.452174 6.678261-6.678261 8.904348-2.226087 2.226087-6.678261 4.452174-11.130434 4.452174s-11.130435 2.226087-20.034783 2.226087h-77.913043c-8.904348 0-15.582609 0-20.034783-2.226087-6.678261-2.226087-11.130435-4.452174-13.356522-6.678261-4.452174-2.226087-6.678261-6.678261-8.904348-13.356522-2.226087-4.452174-2.226087-11.130435-2.226087-20.034783v-26.713043l-120.208695 6.678261v-22.26087l120.208695-6.678261v-33.391304l-97.947826 4.452174v-22.26087l97.947826-4.452174v-28.93913c-15.582609 2.226087-33.391304 2.226087-48.973913 2.226087-15.582609 0-33.391304 2.226087-48.973913 2.226087l-2.226087-22.26087c20.034783 0 42.295652-2.226087 64.556522-4.452174s42.295652-2.226087 64.556522-4.452173c20.034783-2.226087 42.295652-4.452174 60.104348-6.678261 20.034783-2.226087 37.843478-4.452174 55.652174-6.678261l4.452174 22.260869c-17.808696 2.226087-35.617391 4.452174-55.652174 6.678261s-42.295652 4.452174-62.330435 6.678261V690.086957l115.756522-6.678261v22.260869l-117.982609 6.678261v33.391304l153.6-8.904347v22.260869l-153.6 8.904348V801.391304c0 2.226087 2.226087 4.452174 4.452174 6.678261 2.226087 2.226087 4.452174 2.226087 8.904348 4.452174 2.226087 0 6.678261 2.226087 13.356521 2.226087H823.652174c2.226087 0 4.452174-2.226087 6.678261-2.226087l4.452174-4.452174c-2.226087 0-2.226087-2.226087-2.226087-4.452174z m-122.434783-178.086956c11.130435-15.582609 22.26087-31.165217 31.165218-48.973913 8.904348-17.808696 15.582609-33.391304 22.260869-48.973913l24.486957 8.904348c-2.226087 4.452174-4.452174 8.904348-4.452174 13.356521-2.226087 4.452174-4.452174 8.904348-4.452174 13.356522h95.721739v22.26087h-60.104348c4.452174 4.452174 6.678261 11.130435 11.130435 15.582608 4.452174 4.452174 6.678261 8.904348 8.904348 13.356522l-17.808696 13.356522c-2.226087-2.226087-4.452174-6.678261-6.678261-8.904348-2.226087-4.452174-4.452174-6.678261-6.678261-11.130435-2.226087-4.452174-4.452174-6.678261-6.678261-11.130435-2.226087-4.452174-4.452174-6.678261-6.67826-8.904347h-17.808696l-13.356522 26.713043c-4.452174 8.904348-11.130435 15.582609-15.582609 24.486957l-33.391304-13.356522z"
                                    p-id="15449"></path>
                            </svg></div>
                        <div class="card-title">æ”¯å‡ºç¬”æ•°</div>
                        <div class="card-value"></div>
                    </div>
                </div>

                <!-- æˆå‘˜æ”¯å‡ºåˆ—è¡¨ -->
                <div class="members-expense-section">
                    <h3>æˆå‘˜æ”¯å‡ºæ˜ç»†</h3>
                    <div class="members-expense-list">
                        <!-- æˆå‘˜æ”¯å‡ºå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <div class="recent-transactions">
                    <!-- æ”¯å‡ºè®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- å…¶ä»–é¡µé¢çš„å ä½å†…å®¹ -->
            <div id="transactions-page" class="page-content" style="display: none;">
                <!-- æœ€è¿‘äº¤æ˜“è®°å½• -->
                <div class="recent-transactions">
                    <div class="transactions-header">
                        <h1 class="page-title">æœ€è¿‘äº¤æ˜“è®°å½•</h1>
                    </div>
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <div class="transaction-icon">ğŸ”</div>
                            <div class="transaction-details">
                                <h4>åˆé¤æ”¯å‡º</h4>
                                <p>2024-01-15 12:30 | é¤é¥®ç±»</p>
                            </div>
                        </div>
                        <div class="transaction-amount amount-expense">-Â¥45</div>
                    </div>
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <div class="transaction-icon">ğŸ’°</div>
                            <div class="transaction-details">
                                <h4>å·¥èµ„æ”¶å…¥</h4>
                                <p>2024-01-15 09:00 | å·¥èµ„ç±»</p>
                            </div>
                        </div>
                        <div class="transaction-amount amount-income">+Â¥8,500</div>
                    </div>
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <div class="transaction-icon">ğŸ›’</div>
                            <div class="transaction-details">
                                <h4>è¶…å¸‚è´­ç‰©</h4>
                                <p>2024-01-14 18:20 | è´­ç‰©ç±»</p>
                            </div>
                        </div>
                        <div class="transaction-amount amount-expense">-Â¥128</div>
                    </div>
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <div class="transaction-icon">ğŸš—</div>
                            <div class="transaction-details">
                                <h4>åŠ æ²¹è´¹</h4>
                                <p>2024-01-14 16:15 | äº¤é€šç±»</p>
                            </div>
                        </div>
                        <div class="transaction-amount amount-expense">-Â¥200</div>
                    </div>
                </div>
            </div>

            <div id="assets-page" class="page-content" style="display: none;">
                <h1 class="page-title">æˆ¿äº§ç®¡ç†</h1>
                <p>è¿™é‡Œå°†æ˜¾ç¤ºæˆ¿äº§ç®¡ç†ç›¸å…³å†…å®¹...</p>
            </div>

            <div id="investment-page" class="page-content" style="display: none;">
                <h1 class="page-title">æŠ•èµ„ç†è´¢</h1>
                <p>è¿™é‡Œå°†æ˜¾ç¤ºæŠ•èµ„ç†è´¢ç›¸å…³å†…å®¹...</p>
            </div>

            <div id="loans-page" class="page-content" style="display: none;">
                <h1 class="page-title">è´·æ¬¾ç®¡ç†</h1>
                <p>è¿™é‡Œå°†æ˜¾ç¤ºè´·æ¬¾ç®¡ç†ç›¸å…³å†…å®¹...</p>
            </div>

            <div id="statistics-page" class="page-content" style="display: none;">
                <div class="myTitle">
                    <h1 class="page-title">æ•°æ®ç»Ÿè®¡</h1>
                    <div class="statistics-controls">
                        <div class="time-range-selector">
                            <label>èµ·å§‹æœˆä»½ï¼š</label>
                            <input id="statsStartMonth" type="month">
                            <label>ç»“æŸæœˆä»½ï¼š</label>
                            <input id="statsEndMonth" type="month">
                        </div>
                        <button class="refresh-btn" onclick="refreshStatistics()">
                            <span>ğŸ”„</span>
                            <span>åˆ·æ–°æ•°æ®</span>
                        </button>
                    </div>
                </div>

                <!-- ç»Ÿè®¡æ¦‚è§ˆå¡ç‰‡ -->
                <div class="statistics-overview">
                    <div class="overview-card">
                        <div class="card-icon">ğŸ“Š</div>
                        <div class="card-title">å¹³å‡æœˆæ”¶å…¥</div>
                        <div class="card-value" id="avgIncome">Â¥0</div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon">ğŸ“‰</div>
                        <div class="card-title">å¹³å‡æœˆæ”¯å‡º</div>
                        <div class="card-value" id="avgExpense">Â¥0</div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon">ğŸ’°</div>
                        <div class="card-title">å¹³å‡æœˆç»“ä½™</div>
                        <div class="card-value" id="avgBalance">Â¥0</div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon">ğŸ“ˆ</div>
                        <div class="card-title">æ€»äº¤æ˜“ç¬”æ•°</div>
                        <div class="card-value" id="totalTransactions">0</div>
                        <div class="card-change">å†å²ç´¯è®¡</div>
                    </div>
                </div>

                <!-- å›¾è¡¨åŒºåŸŸ -->
                <div class="charts-container">
                    <!-- æœˆåº¦æ”¶æ”¯è¶‹åŠ¿å›¾ -->
                    <div class="chart-section">
                        <div class="chart-header">
                            <h3>æœˆåº¦æ”¶æ”¯è¶‹åŠ¿</h3>
                            <div class="chart-legend">
                                <span class="legend-item income">â— æ”¶å…¥</span>
                                <span class="legend-item expense">â— æ”¯å‡º</span>
                                <span class="legend-item balance">â— ç»“ä½™</span>
                            </div>
                        </div>
                        <div class="chart-container">
                            <div id="monthlyTrendChart" class="chart"></div>
                        </div>
                    </div>

                    <!-- æ”¶æ”¯å¯¹æ¯”å›¾ -->
                    <div class="chart-section">
                        <div class="chart-header">
                            <h3>æ”¶æ”¯å¯¹æ¯”åˆ†æ</h3>
                        </div>
                        <div class="chart-container">
                            <div id="incomeExpenseChart" class="chart"></div>
                        </div>
                    </div>

                    <!-- æ”¯å‡ºåˆ†ç±»ç»Ÿè®¡ -->
                    <div class="chart-section">
                        <div class="chart-header">
                            <h3>æ”¯å‡ºåˆ†ç±»ç»Ÿè®¡</h3>
                        </div>
                        <div class="chart-container">
                            <div id="expenseCategoryChart" class="chart"></div>
                        </div>
                    </div>

                    <!-- æ”¶å…¥åˆ†ç±»ç»Ÿè®¡ -->
                    <div class="chart-section">
                        <div class="chart-header">
                            <h3>æ”¶å…¥åˆ†ç±»ç»Ÿè®¡</h3>
                        </div>
                        <div class="chart-container">
                            <div id="incomeCategoryChart" class="chart"></div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- æ”¶å…¥è®°å½•æ¨¡æ€æ¡† -->
    <div id="incomeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">è®°å½•æ”¶å…¥</h3>
                <button class="close-btn" onclick="closeModal('income')">&times;</button>
            </div>
            <form id="incomeForm">
                <div class="form-group">
                    <label>æ”¶å…¥é‡‘é¢</label>
                    <input name="amount" type="number" placeholder="è¯·è¾“å…¥æ”¶å…¥é‡‘é¢" required>
                </div>
                <div class="form-group">
                    <label>æ”¶å…¥ç±»å‹</label>
                    <select name="category" required>
                        <option value="">è¯·é€‰æ‹©æ”¶å…¥ç±»å‹</option>
                        <option value="å·¥èµ„">å·¥èµ„æ”¶å…¥</option>
                        <option value="å¥–é‡‘">å¥–é‡‘æ”¶å…¥</option>
                        <option value="æŠ•èµ„å—ç›Š">æŠ•èµ„æ”¶ç›Š</option>
                        <option value="å…¶ä»–">å…¶ä»–æ”¶å…¥</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>æ”¶å…¥æ—¥æœŸ</label>
                    <input name="occurred_at" type="date" required>
                </div>
                <div class="form-group">
                    <label>å¤‡æ³¨è¯´æ˜</label>
                    <textarea name="note" placeholder="è¯·è¾“å…¥å¤‡æ³¨è¯´æ˜" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn">ä¿å­˜æ”¶å…¥è®°å½•</button>
            </form>
        </div>
    </div>

    <!-- æ”¯å‡ºè®°å½•æ¨¡æ€æ¡† -->
    <div id="expenseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">è®°å½•æ”¯å‡º</h3>
                <button class="close-btn" onclick="closeModal('expense')">&times;</button>
            </div>
            <form id="expenseForm">
                <div class="form-group">
                    <label>æ”¯å‡ºé‡‘é¢</label>
                    <input name="amount" type="number" placeholder="è¯·è¾“å…¥æ”¯å‡ºé‡‘é¢" required>
                </div>
                <div class="form-group">
                    <label>æ”¯å‡ºåˆ†ç±»</label>
                    <select name="category" required>
                        <option value="">è¯·é€‰æ‹©æ”¯å‡ºåˆ†ç±»</option>
                        <option value="é¤é¥®">é¤é¥®æ”¯å‡º</option>
                        <option value="è´­ç‰©">è´­ç‰©æ”¯å‡º</option>
                        <option value="äº¤é€š">äº¤é€šæ”¯å‡º</option>
                        <option value="å¨±ä¹">å¨±ä¹æ”¯å‡º</option>
                        <option value="åŒ»ç–—">åŒ»ç–—æ”¯å‡º</option>
                        <option value="æ•™è‚²">æ•™è‚²æ”¯å‡º</option>
                        <option value="å…¶ä»–">å…¶ä»–æ”¯å‡º</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>æ”¯å‡ºæ—¥æœŸ</label>
                    <input name="occurred_at" type="date" required>
                </div>
                <div class="form-group">
                    <label>å¤‡æ³¨è¯´æ˜</label>
                    <textarea name="note" placeholder="è¯·è¾“å…¥å¤‡æ³¨è¯´æ˜" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn">ä¿å­˜æ”¯å‡ºè®°å½•</button>
            </form>
        </div>
    </div>

    <!-- é‚€è¯·æˆå‘˜æ¨¡æ€æ¡† -->
    <div id="inviteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">é‚€è¯·å®¶åº­æˆå‘˜</h3>
                <button class="close-btn" onclick="closeModal('invite')">&times;</button>
            </div>
            <form>
                <div class="form-group">
                    <label>è¢«é‚€è¯·äººé‚®ç®±</label>
                    <input type="email" placeholder="è¯·è¾“å…¥è¢«é‚€è¯·äººçš„é‚®ç®±åœ°å€" required>
                </div>
                <div class="form-group">
                    <label>é‚€è¯·äººå§“å</label>
                    <input type="text" placeholder="è¯·è¾“å…¥è¢«é‚€è¯·äººçš„å§“å" required>
                </div>
                <div class="form-group">
                    <label>é‚€è¯·æ¶ˆæ¯</label>
                    <textarea placeholder="è¯·è¾“å…¥é‚€è¯·æ¶ˆæ¯ï¼ˆå¯é€‰ï¼‰" rows="3">æ‚¨å¥½ï¼æˆ‘é‚€è¯·æ‚¨åŠ å…¥æˆ‘ä»¬çš„å®¶åº­è´¢åŠ¡ç®¡ç†ï¼Œä¸€èµ·ç®¡ç†å®¶åº­æ”¶æ”¯ã€‚</textarea>
                </div>
                <button type="submit" class="submit-btn">å‘é€é‚€è¯·</button>
            </form>
        </div>
    </div>

    <!-- è®¾ç½®é¢„ç®—æ¨¡æ€æ¡† -->
    <div id="budgetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">è®¾ç½®é¢„ç®—</h3>
                <button class="close-btn" onclick="closeModal('budget')">&times;</button>
            </div>
            <form id="budgetForm">
                <div class="form-group">
                    <label>é¢„ç®—æœˆä»½</label>
                    <input name="budgetMonth" type="month" required>
                </div>
                <div class="form-group">
                    <label>æœ¬æœˆé¢„ç®—é‡‘é¢</label>
                    <input name="budgetAmount" type="number" placeholder="è¯·è¾“å…¥æœ¬æœˆé¢„ç®—é‡‘é¢" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>é¢„ç®—è¯´æ˜</label>
                    <textarea name="budgetNote" placeholder="è¯·è¾“å…¥é¢„ç®—è¯´æ˜ï¼ˆå¯é€‰ï¼‰" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn">ä¿å­˜é¢„ç®—</button>
            </form>
        </div>
    </div>

    <!-- äº¤æ˜“è®°å½•æŸ¥çœ‹å¼¹çª— -->
    <div id="transactionsModal" class="modal">
        <div class="modal-content transactions-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">æ‰€æœ‰äº¤æ˜“è®°å½•</h3>
                <button class="close-btn" onclick="closeModal('transactions')">&times;</button>
            </div>
            <div class="transactions-list" id="transactionsList">
                <!-- äº¤æ˜“è®°å½•å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- å®¶åº­äº¤æ˜“è®°å½•æŸ¥çœ‹å¼¹çª— -->
    <div id="familyTransactionsModal" class="modal">
        <div class="modal-content transactions-modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="familyTransactionsTitle">æ‰€æœ‰äº¤æ˜“è®°å½•</h3>
                <button class="close-btn" onclick="closeModal('familyTransactions')">&times;</button>
            </div>
            <div class="transactions-controls">
                <div class="category-filter">
                    <label>åˆ†ç±»ç­›é€‰ï¼š</label>
                    <select id="familyCategoryFilter">
                        <option value="all">å…¨éƒ¨</option>
                        <option value="å·¥èµ„">å·¥èµ„</option>
                        <option value="å¥–é‡‘">å¥–é‡‘</option>
                        <option value="æŠ•èµ„å—ç›Š">æŠ•èµ„</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </div>
                <div class="member-filter">
                    <label>æˆå‘˜ç­›é€‰ï¼š</label>
                    <select id="familyMemberFilter">
                        <option value="all">å…¨éƒ¨æˆå‘˜</option>
                    </select>
                </div>
            </div>
            <div class="transactions-list" id="familyTransactionsList">
                <!-- å®¶åº­äº¤æ˜“è®°å½•å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>

        const baseUrl = "http://lemonyaweb.top:16384"

        // æˆå‘˜æ•°ç»„
        let members = [];

        //
        const token = sessionStorage.getItem("token")
        const username = sessionStorage.getItem("username")

        // é¢„ç®—ï¼šä½¿ç”¨å†…å­˜ä¸­çš„å½“å‰é¢„ç®—å¯¹è±¡æ›¿ä»£æœ¬åœ°å­˜å‚¨
        let currentBudget = null;

        // é¢„ç®—æœ¬åœ°å­˜å‚¨å·¥å…·æ–¹æ³•
        function getBudgetStorageKey(startDate) {
            const user = username || 'guest';
            return `ffm_budget_${user}_${startDate}`;
        }

        function normalizeBudget(budget) {
            if (!budget) return null;
            const start = budget.start_date || budget.StartDate || budget.time || budget.Time;
            const amount = (budget.amount !== undefined ? budget.amount : budget.Amount);
            const note = (budget.note !== undefined ? budget.note : budget.Note) || '';
            if (!start) return null;
            const numAmount = typeof amount === 'string' ? parseFloat(amount) : amount;
            if (isNaN(numAmount)) return { start_date: start, amount: 0, note };
            return { start_date: start, amount: numAmount, note };
        }

        function saveBudgetToLocal(budget) {
            const normalized = normalizeBudget(budget);
            if (!normalized || !normalized.start_date) return;
            try {
                const key = getBudgetStorageKey(normalized.start_date);
                localStorage.setItem(key, JSON.stringify(normalized));
            } catch (e) {
                console.log('ä¿å­˜é¢„ç®—åˆ°æœ¬åœ°å¤±è´¥:', e);
            }
        }

        function loadBudgetFromLocal() {
            try {
                const startDate = getBudgetMonthStartDate();
                const key = getBudgetStorageKey(startDate);
                const raw = localStorage.getItem(key);
                if (!raw) return null;
                const parsed = JSON.parse(raw);
                return normalizeBudget(parsed);
            } catch (e) {
                console.log('ä»æœ¬åœ°è¯»å–é¢„ç®—å¤±è´¥:', e);
                return null;
            }
        }

        // è·å–å½“å‰æœˆä»½é¦–æ—¥ï¼Œæ ¼å¼å¦‚ YYYY-MM-01ï¼ˆè¡¥é›¶ï¼‰
        function getBudgetMonthStartDate() {
            const now = new Date();
            const y = now.getFullYear();
            const m = (now.getMonth() + 1).toString().padStart(2, '0');
            return `${y}-${m}-01`;
        }

        // é¡µé¢åˆ‡æ¢åŠŸèƒ½
        function showPage(pageName, menuItem = null) {
            // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });

            // æ·»åŠ å½“å‰é¡µé¢çš„æ´»åŠ¨çŠ¶æ€
            if (menuItem) {
                menuItem.classList.add('active');
            } else if (event && event.target) {
                event.target.closest('.menu-item').classList.add('active');
            } else {
                // å¦‚æœæ²¡æœ‰eventå¯¹è±¡ï¼Œé€šè¿‡é¡µé¢åç§°æ‰¾åˆ°å¯¹åº”çš„èœå•é¡¹
                const menuItems = document.querySelectorAll('.menu-item');
                menuItems.forEach(item => {
                    if (item.getAttribute('onclick') && item.getAttribute('onclick').includes(pageName)) {
                        item.classList.add('active');
                    }
                });
            }

            // éšè—æ‰€æœ‰é¡µé¢å†…å®¹
            document.querySelectorAll('.page-content').forEach(page => {
                page.style.display = 'none';
            });

            // æ˜¾ç¤ºç›®æ ‡é¡µé¢
            const targetPage = document.getElementById(pageName + '-page');
            if (targetPage) {
                targetPage.style.display = 'block';

                // å…ˆæ ¹æ®æˆå‘˜çŠ¶æ€æ¸²æŸ“ï¼Œé¿å…å†…å®¹é—ªç°
                try { renderFamilyStatus(); } catch (e) { }

                // æ·»åŠ æ·¡å…¥åŠ¨ç”»æ•ˆæœ
                targetPage.style.opacity = '0';
                targetPage.style.transform = 'translateY(20px)';

                setTimeout(() => {
                    targetPage.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                    targetPage.style.opacity = '1';
                    targetPage.style.transform = 'translateY(0)';

                    // å¦‚æœæ˜¯ç»Ÿè®¡é¡µé¢ï¼Œåˆå§‹åŒ–ç»Ÿè®¡æ•°æ®
                    if (pageName === 'statistics') {
                        setTimeout(() => {
                            initStatisticsPage();
                        }, 100);
                    }
                }, 10);
            } else {
                console.warn('é¡µé¢ä¸å­˜åœ¨:', pageName);
            }

            console.log('åˆ‡æ¢åˆ°é¡µé¢:', pageName);
        }

        // ç¡®ä¿é¡µé¢å†…å­˜åœ¨æœªåŠ å…¥å®¶åº­æç¤ºèŠ‚ç‚¹
        function ensureNoFamilyNotice(pageEl) {
            if (!pageEl.querySelector('.no-family-notice')) {
                const notice = document.createElement('div');
                notice.className = 'no-family-notice';
                const text = document.createElement('span');
                text.textContent = 'å½“å‰æœªåŠ å…¥å®¶åº­';
                const btn = document.createElement('button');
                btn.className = 'action-btn';
                btn.style.margin = '10px auto';
                btn.textContent = 'å»åˆ›å»º';
                btn.onclick = createFamily;
                notice.appendChild(text);
                notice.appendChild(btn);
                pageEl.insertBefore(notice, pageEl.firstChild);
            }
        }

        // æ ¹æ® members æ˜¯å¦ä¸ºç©ºæ§åˆ¶å®¶åº­ç›¸å…³é¡µé¢çš„å±•ç¤º
        function renderFamilyStatus() {
            const isEmpty = !members || members.length === 0;
            // åªæœ‰å®¶åº­æ¦‚è§ˆå’Œç»Ÿè®¡é¡µé¢éœ€è¦å®¶åº­çŠ¶æ€ï¼Œæ”¶å…¥å’Œæ”¯å‡ºé¡µé¢ä¸ªäººç”¨æˆ·ä¹Ÿå¯ä»¥ä½¿ç”¨
            const pageIds = ['dashboard-page', 'statistics-page'];
            pageIds.forEach(id => {
                const page = document.getElementById(id);
                if (!page) return;
                ensureNoFamilyNotice(page);
                const notice = page.querySelector('.no-family-notice');
                if (isEmpty) {
                    notice.style.display = 'block';
                    Array.from(page.children).forEach(child => {
                        if (child !== notice) {
                            child.style.display = 'none';
                        }
                    });
                } else {
                    if (notice) notice.style.display = 'none';
                    Array.from(page.children).forEach(child => {
                        if (child !== notice) {
                            child.style.display = '';
                        }
                    });
                    // æ¸²æŸ“æˆå‘˜åˆ—è¡¨
                    renderMembersUI();
                }
            });

            // ç¡®ä¿æ”¶å…¥å’Œæ”¯å‡ºé¡µé¢æ²¡æœ‰"æ²¡æœ‰åŠ å…¥å®¶åº­"çš„æç¤º
            const personalPageIds = ['income-page', 'expense-page'];
            personalPageIds.forEach(id => {
                const page = document.getElementById(id);
                if (!page) return;
                const notice = page.querySelector('.no-family-notice');
                if (notice) {
                    notice.style.display = 'none';
                }
                // ç¡®ä¿é¡µé¢å†…å®¹æ­£å¸¸æ˜¾ç¤º
                Array.from(page.children).forEach(child => {
                    if (child !== notice) {
                        child.style.display = '';
                    }
                });
            });
        }

        // æ ¹æ® members æ¸²æŸ“æˆå‘˜å¡ç‰‡
        function renderMembersUI() {
            const listEl = document.querySelector('.members-list');
            if (!listEl) return;
            listEl.innerHTML = '';
            (members || []).forEach(m => {
                const card = document.createElement('div');
                card.className = 'member-card';
                const avatar = document.createElement('div');
                avatar.className = 'member-avatar';
                avatar.textContent = 'ğŸ‘¤';
                const name = document.createElement('div');
                name.className = 'member-name';
                name.textContent = m.username || m.name || 'æˆå‘˜';
                const role = document.createElement('div');
                role.className = 'member-role';
                role.textContent = m.role || 'å®¶åº­æˆå‘˜';
                if (role.textContent === '1') {
                    role.textContent = 'ç®¡ç†å‘˜'
                }
                card.appendChild(avatar);
                card.appendChild(name);
                card.appendChild(role);
                listEl.appendChild(card);
            });
        }

        // æ¨¡æ€æ¡†åŠŸèƒ½
        function openModal(modalType) {
            const modal = document.getElementById(modalType + 'Modal');
            if (modal) {
                modal.style.display = 'block';
                // æ‰“å¼€é¢„ç®—å¼¹çª—æ—¶ï¼Œé»˜è®¤é€‰æ‹©å½“å‰æœˆ
                if (modalType === 'budget') {
                    const monthInput = modal.querySelector('input[name="budgetMonth"]');
                    if (monthInput) {
                        const now = new Date();
                        const y = now.getFullYear();
                        const m = (now.getMonth() + 1).toString().padStart(2, '0');
                        monthInput.value = `${y}-${m}`;
                    }
                }
            }
        }

        function closeModal(modalType) {
            const modal = document.getElementById(modalType + 'Modal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.onclick = function (event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // é€€å‡ºç™»å½•
        function logout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                window.location.href = 'login.html';
            }
        }

        // è¡¨å•æäº¤å¤„ç†
        // 1) æ”¶å…¥
        document.getElementById('incomeForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const formData = new FormData(this);
            const payload = {
                type: 1,
                amount: parseFloat(formData.get('amount')),
                category: String(formData.get('category') || ''),
                occurred_at: String(formData.get('occurred_at') || ''),
                note: String(formData.get('note') || ''),
                merchant: '11',
                location: '11',
                payment_method: '11'
            };
            console.log(payload);

            axios({
                method: 'post',
                url: baseUrl + '/api/v1/bills',
                headers: { 'Content-Type': 'application/json', Authorization: token },
                data: payload
            }).then(() => {
                alert('æ”¶å…¥å·²è®°å½•');
                closeModal('income');
                this.reset();
                // åˆ·æ–°ä¸ªäººæ•°æ®å’Œå®¶åº­æ•°æ®
                loadPersonalBills();
                updateFamilyData();
            }).catch(err => {
                console.log(err);
                alert('è®°å½•å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
            });
        });

        // 2) æ”¯å‡º
        document.getElementById('expenseForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const formData = new FormData(this);
            const payload = {
                type: 0,
                amount: parseFloat(formData.get('amount')),
                category: String(formData.get('category') || ''),
                occurred_at: String(formData.get('occurred_at') || ''),
                note: String(formData.get('note') || '')
            };
            axios({
                method: 'post',
                url: baseUrl + '/api/v1/bills',
                headers: { 'Content-Type': 'application/json', Authorization: token },
                data: payload
            }).then(() => {
                alert('æ”¯å‡ºå·²è®°å½•');
                closeModal('expense');
                this.reset();
                // åˆ·æ–°ä¸ªäººæ•°æ®å’Œå®¶åº­æ•°æ®
                loadPersonalBills();
                updateFamilyData();
            }).catch(err => {
                console.log(err);
                alert('è®°å½•å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
            });
        });

        // 3) é¢„ç®—è®¾ç½®
        document.getElementById('budgetForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const formData = new FormData(this);
            const budgetAmount = parseFloat(formData.get('budgetAmount'));
            const budgetNote = formData.get('budgetNote') || '';
            const budgetMonth = formData.get('budgetMonth'); // YYYY-MM

            if (budgetAmount <= 0) {
                alert('é¢„ç®—é‡‘é¢å¿…é¡»å¤§äº0');
                return;
            }

            // ç”Ÿæˆé€‰æ‹©æœˆä»½çš„é¦–æ—¥
            let startDate = getBudgetMonthStartDate();
            if (budgetMonth && /\d{4}-\d{2}/.test(budgetMonth)) {
                startDate = `${budgetMonth}-01`;
            }
            const payload = {
                amount: budgetAmount,
                start_date: startDate,
                note: budgetNote
            };

            axios({
                method: 'post',
                url: baseUrl + '/api/v1/budget',
                headers: { 'Content-Type': 'application/json', Authorization: token },
                data: payload
            }).then(response => {
                // æˆåŠŸåï¼Œæ›´æ–°å†…å­˜ä¸­çš„é¢„ç®—å¹¶åˆ·æ–°æ˜¾ç¤º
                currentBudget = normalizeBudget({
                    amount: budgetAmount,
                    start_date: startDate,
                    note: budgetNote
                });
                // æœ¬åœ°æŒä¹…åŒ–
                saveBudgetToLocal(currentBudget);
                alert('é¢„ç®—è®¾ç½®æˆåŠŸï¼');
                closeModal('budget');
                this.reset();
                updateBudgetDisplay();
                updateFamilyData();
            }).catch(err => {
                console.log(err);
                alert('è®¾ç½®é¢„ç®—å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
            });
        });

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function () {
            // å…ˆæ ¹æ®æˆå‘˜çŠ¶æ€æ¸²æŸ“ï¼Œå†æ˜¾ç¤ºé»˜è®¤é¡µé¢ï¼Œé¿å…åˆæ¬¡è¿›å…¥å†…å®¹é—ªç°
            renderFamilyStatus();
            showPage('dashboard_one');

            // åˆå§‹åŒ–é¢„ç®—ï¼šä¼˜å…ˆä»åç«¯æ‹‰å–ï¼Œå¤±è´¥æˆ–æ— æ•°æ®åˆ™ä»æœ¬åœ°æ¢å¤ï¼ˆé»˜è®¤å½“æœˆï¼‰
            fetchCurrentBudget()
                .then(() => {
                    if (!currentBudget || !currentBudget.amount) {
                        const local = loadBudgetFromLocal();
                        if (local) currentBudget = local;
                    }
                })
                .catch(() => {
                    const local = loadBudgetFromLocal();
                    if (local) currentBudget = local;
                })
                .finally(() => {
                    updateBudgetDisplay();
                });

            // æ—¶é—´èŒƒå›´é€‰æ‹©å™¨å·²ç§»é™¤ï¼Œå›ºå®šä¸º6ä¸ªæœˆæ•°æ®

            console.log('ç®¡å®¶å©†å®¶åº­è´¢åŠ¡ç®¡ç†ç³»ç»Ÿå·²åŠ è½½');
        });



        // axios({
        //     method: 'get',
        //     url:  baseUrl + '/api/v1/bills/income',
        //     headers: { 'Content-Type': 'application/json', Authorization: token },
        //     params: {
        //         start_date: "2025-9-4",
        //         end_date: "2025-9-10",
        //         category: 'å·¥èµ„'
        //     }
        // }).then(response => {
        //     console.log(response);


        // }).catch(err => {
        //     console.log(err);
        //     alert('è·å–æ”¶å…¥å¤±è´¥');
        // });



        // è·å–ä¸ªäººè´¦å•
        const account = []

        // æ ¹æ®ç±»åˆ«è·å–å›¾æ ‡çš„å‡½æ•°
        function getCategoryIcon(category) {
            const iconMap = {
                'é¤é¥®': 'ğŸ”',
                'å·¥èµ„': 'ğŸ’°',
                'è´­ç‰©': 'ğŸ›’',
                'äº¤é€š': 'ğŸš—',
                'å¨±ä¹': 'ğŸ¬',
                'åŒ»ç–—': 'ğŸ¥',
                'æ•™è‚²': 'ğŸ“š',
                'ä½æˆ¿': 'ğŸ ',
                'æœè£…': 'ğŸ‘•',
                'å…¶ä»–': 'ğŸ“'
            };
            return iconMap[category] || 'ğŸ“';
        }

        // æ¸²æŸ“ä¸ªäººæ•°æ®é¡µé¢æœ€è¿‘äº¤æ˜“è®°å½•çš„å‡½æ•°
        function renderPersonalRecentTransactions(transactions, limit = 5) {
            const container = document.querySelector('#dashboard_one-page .recent-transactions');
            if (!container) return;

            // æŒ‰æ—¶é—´æˆ³ä»è¿‘åˆ°è¿œæ’åº
            const sortedTransactions = transactions.sort((a, b) => new Date(b.occurred_at) - new Date(a.occurred_at));

            // è·å–æŒ‡å®šæ•°é‡çš„è®°å½•
            const recentTransactions = limit ? sortedTransactions.slice(0, limit) : sortedTransactions;

            // ç”ŸæˆHTML
            let html = `
                <div class="transactions-header">
                    <h3>æœ€è¿‘äº¤æ˜“è®°å½•</h3>
                    <a href="#" class="view-all-btn" onclick="showAllPersonalTransactions()">æŸ¥çœ‹å…¨éƒ¨</a>
                </div>
            `;

            if (recentTransactions.length === 0) {
                html += '<div class="no-transactions">æš‚æ— äº¤æ˜“è®°å½•</div>';
            } else {
                recentTransactions.forEach(transaction => {
                    const isIncome = transaction.type === 1;
                    const amount = parseFloat(transaction.amount);

                    // ä¿®å¤æ—¥æœŸæ˜¾ç¤ºé—®é¢˜
                    let formattedDate;
                    if (transaction.occurred_at) {
                        // å°è¯•ä¸åŒçš„æ—¥æœŸæ ¼å¼è§£æ
                        let date;
                        if (typeof transaction.occurred_at === 'string') {
                            // å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œå°è¯•è§£æ
                            date = new Date(transaction.occurred_at);
                        } else if (typeof transaction.occurred_at === 'number') {
                            // å¦‚æœæ˜¯æ•°å­—ï¼Œå¯èƒ½æ˜¯æ—¶é—´æˆ³
                            date = new Date(transaction.occurred_at * 1000); // å‡è®¾æ˜¯ç§’çº§æ—¶é—´æˆ³
                        } else {
                            date = new Date(transaction.occurred_at);
                        }

                        // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ
                        if (isNaN(date.getTime())) {
                            formattedDate = 'æ—¥æœŸæ— æ•ˆ';
                        } else {
                            const y = date.getFullYear();
                            const m = String(date.getMonth() + 1).padStart(2, '0');
                            const d = String(date.getDate()).padStart(2, '0');
                            formattedDate = `${y}-${m}-${d}`;
                        }
                    } else {
                        formattedDate = 'æ— æ—¥æœŸ';
                    }

                    // æ ¹æ®ç±»åˆ«é€‰æ‹©å›¾æ ‡
                    const icon = getCategoryIcon(transaction.category);

                    html += `
                        <div class="transaction-item">
                            <div class="transaction-info">
                                <div class="transaction-icon">${icon}</div>
                                <div class="transaction-details">
                                    <h4>${transaction.note || transaction.category}</h4>
                                    <p>${formattedDate} | ${transaction.category}</p>
                                </div>
                            </div>
                            <div class="transaction-amount ${isIncome ? 'amount-income' : 'amount-expense'}">
                                ${isIncome ? '+' : '-'}Â¥${amount.toFixed(2)}
                            </div>
                        </div>
                    `;
                });
            }

            container.innerHTML = html;
        }

        // æ˜¾ç¤ºæ‰€æœ‰ä¸ªäººäº¤æ˜“è®°å½•çš„å‡½æ•°ï¼ˆå…¨å±€å‡½æ•°ï¼‰
        function showAllPersonalTransactions() {
            openTransactionsModal();
        }

        // æ‰“å¼€äº¤æ˜“è®°å½•å¼¹çª—
        function openTransactionsModal() {
            const modal = document.getElementById('transactionsModal');
            const transactionsList = document.getElementById('transactionsList');

            if (!modal || !transactionsList) return;

            // æŒ‰æ—¶é—´æˆ³ä»è¿‘åˆ°è¿œæ’åº
            const sortedTransactions = account.sort((a, b) => new Date(b.occurred_at) - new Date(a.occurred_at));

            // ç”ŸæˆHTML
            let html = '';

            if (sortedTransactions.length === 0) {
                html = '<div class="no-transactions">æš‚æ— äº¤æ˜“è®°å½•</div>';
            } else {
                sortedTransactions.forEach(transaction => {
                    const isIncome = transaction.type === 1;
                    const amount = parseFloat(transaction.amount);

                    // ä¿®å¤æ—¥æœŸæ˜¾ç¤ºé—®é¢˜
                    let formattedDate;
                    if (transaction.occurred_at) {
                        // å°è¯•ä¸åŒçš„æ—¥æœŸæ ¼å¼è§£æ
                        let date;
                        if (typeof transaction.occurred_at === 'string') {
                            // å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œå°è¯•è§£æ
                            date = new Date(transaction.occurred_at);
                        } else if (typeof transaction.occurred_at === 'number') {
                            // å¦‚æœæ˜¯æ•°å­—ï¼Œå¯èƒ½æ˜¯æ—¶é—´æˆ³
                            date = new Date(transaction.occurred_at * 1000); // å‡è®¾æ˜¯ç§’çº§æ—¶é—´æˆ³
                        } else {
                            date = new Date(transaction.occurred_at);
                        }

                        // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ
                        if (isNaN(date.getTime())) {
                            formattedDate = 'æ—¥æœŸæ— æ•ˆ';
                        } else {
                            const y = date.getFullYear();
                            const m = String(date.getMonth() + 1).padStart(2, '0');
                            const d = String(date.getDate()).padStart(2, '0');
                            formattedDate = `${y}-${m}-${d}`;
                        }
                    } else {
                        formattedDate = 'æ— æ—¥æœŸ';
                    }

                    // æ ¹æ®ç±»åˆ«é€‰æ‹©å›¾æ ‡
                    const icon = getCategoryIcon(transaction.category);

                    html += `
                        <div class="transaction-item">
                            <div class="transaction-info">
                                <div class="transaction-icon">${icon}</div>
                                <div class="transaction-details">
                                    <h4>${transaction.note || transaction.category}</h4>
                                    <p>${formattedDate} | ${transaction.category}</p>
                                </div>
                            </div>
                            <div class="transaction-amount ${isIncome ? 'amount-income' : 'amount-expense'}">
                                ${isIncome ? '+' : '-'}Â¥${amount.toFixed(2)}
                            </div>
                        </div>
                    `;
                });
            }

            transactionsList.innerHTML = html;
            modal.style.display = 'block';
        }

        // è·å–ä¸ªäººè´¦å•æ•°æ®ï¼ˆåªè·å–å½“å‰ç”¨æˆ·çš„è´¦å•ï¼‰
        async function loadPersonalBills() {
            try {
                const now = new Date();
                const currentYear = now.getFullYear();
                const currentMonth = now.getMonth() + 1;

                // è®¡ç®—æœˆä»½çš„å¼€å§‹å’Œç»“æŸæ—¥æœŸ
                const startDate = `${currentYear}-${currentMonth.toString().padStart(2, '0')}-01`;
                const lastDay = new Date(currentYear, currentMonth, 0).getDate();
                const endDate = `${currentYear}-${currentMonth.toString().padStart(2, '0')}-${lastDay}`;

                // è·å–å½“å‰ç”¨æˆ·çš„è´¦å•æ•°æ®ï¼ˆä½¿ç”¨memberå‚æ•°ï¼‰
                const response = await axios({
                    method: 'get',
                    url: baseUrl + '/api/v1/bills',
                    headers: { 'Content-Type': 'application/json', Authorization: token },
                    params: {
                        start_date: startDate,
                        end_date: endDate,
                        member: username // ä½¿ç”¨å½“å‰ç”¨æˆ·åä½œä¸ºmemberå‚æ•°
                    }
                });

                console.log('ä¸ªäººè´¦å•å“åº”:', response);

                if (response.data.message === "OK") {
                    const personalBills = response.data.response.bills || [];
                    console.log('ä¸ªäººè´¦å•æ•°æ®:', personalBills);

                    // æ›´æ–°å…¨å±€è´¦æˆ·æ•°ç»„
                    account.splice(0, account.length);
                    personalBills.forEach(bill => {
                        account.push(bill);
                    });

                    console.log('æœ€ç»ˆä¸ªäººè´¦å•æ•°æ®:', account);

                    // æ¸²æŸ“ä¸ªäººæ•°æ®é¡µé¢çš„æœ€è¿‘5æ¡äº¤æ˜“è®°å½•
                    renderPersonalRecentTransactions(account, 5);

                    // æ›´æ–°ä¸ªäººæ•°æ®é¡µé¢çš„ç»Ÿè®¡æ•°æ®
                    updatePersonalDataStats();
                }

            } catch (err) {
                console.log('è·å–ä¸ªäººè´¦å•å¤±è´¥:', err);
            }
        }

        // è°ƒç”¨è·å–ä¸ªäººè´¦å•å‡½æ•°
        loadPersonalBills();

        // è·å–æŒ‡å®šæœˆä»½çš„æ”¶å…¥æˆ–æ”¯å‡ºæ•°æ®
        async function getMonthlyData(type, year, month, memberId = null) {
            try {
                // è®¡ç®—æœˆä»½çš„å¼€å§‹å’Œç»“æŸæ—¥æœŸ
                const startDate = `${year}-${month.toString().padStart(2, '0')}-01`;
                const lastDay = new Date(year, month, 0).getDate();
                const endDate = `${year}-${month.toString().padStart(2, '0')}-${lastDay}`;

                const url = type === 'income' ?
                    baseUrl + '/api/v1/bills/income' :
                    baseUrl + '/api/v1/bills/outcome';

                const params = {
                    start_date: startDate,
                    end_date: endDate
                };

                // å¦‚æœæŒ‡å®šäº†æˆå‘˜IDï¼Œåˆ™æ·»åŠ åˆ°å‚æ•°ä¸­
                if (memberId) {
                    params.member_id = memberId;
                }

                console.log(`è·å–${type}æ•°æ® - memberId: ${memberId}, params:`, params);

                const response = await axios({
                    method: 'get',
                    url: url,
                    headers: { 'Content-Type': 'application/json', Authorization: token },
                    params: params
                });

                console.log(`${type} APIå“åº”:`, response.data);

                const amount = response.data.response.amount || 0;
                console.log(`è§£æå‡ºçš„${type}é‡‘é¢:`, amount);
                return amount;
            } catch (err) {
                console.log(`è·å–${type}æ•°æ®å¤±è´¥:`, err);
                return 0;
            }
        }


        // æ›´æ–°ä¸ªäººæ•°æ®é¡µé¢çš„ç»Ÿè®¡æ•°æ®
        function updatePersonalDataStats() {
            try {
                // ç›´æ¥ä»å…¨å±€accountæ•°ç»„è®¡ç®—ç»Ÿè®¡æ•°æ®
                const income = account.filter(bill => bill.type === 1).reduce((sum, bill) => sum + parseFloat(bill.amount), 0);
                const expense = account.filter(bill => bill.type === 0).reduce((sum, bill) => sum + parseFloat(bill.amount), 0);
                const balance = income - expense;

                console.log('ä¸ªäººæ•°æ® - æ”¶å…¥:', income, 'æ”¯å‡º:', expense, 'ç»“ä½™:', balance);

                // æ›´æ–°é¡µé¢æ˜¾ç¤º
                updatePersonalDataDisplay(income, expense, balance);

            } catch (err) {
                console.log('æ›´æ–°ä¸ªäººæ•°æ®å¤±è´¥:', err);
                // å¦‚æœè·å–å¤±è´¥ï¼Œæ˜¾ç¤ºé»˜è®¤å€¼
                updatePersonalDataDisplay(0, 0, 0);
            }
        }

        // æ›´æ–°ä¸ªäººæ•°æ®é¡µé¢çš„æ˜¾ç¤º
        function updatePersonalDataDisplay(income, expense, balance) {
            // æ›´æ–°æœ¬æœˆæ”¶å…¥
            const incomeCard = document.querySelector('#dashboard_one-page .overview-card:nth-child(1)');
            if (incomeCard) {
                const valueElement = incomeCard.querySelector('.card-value');
                const changeElement = incomeCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = `Â¥${income.toLocaleString()}`;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆæ”¶å…¥';
            }

            // æ›´æ–°æœ¬æœˆæ”¯å‡º
            const expenseCard = document.querySelector('#dashboard_one-page .overview-card:nth-child(2)');
            if (expenseCard) {
                const valueElement = expenseCard.querySelector('.card-value');
                const changeElement = expenseCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = `Â¥${expense.toLocaleString()}`;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆæ”¯å‡º';
            }

            // æ›´æ–°æœ¬æœˆç»“ä½™
            const balanceCard = document.querySelector('#dashboard_one-page .overview-card:nth-child(3)');
            if (balanceCard) {
                const valueElement = balanceCard.querySelector('.card-value');
                const changeElement = balanceCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = `Â¥${balance.toLocaleString()}`;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆç»“ä½™';
            }

            // æ›´æ–°æ”¶å…¥ç¬”æ•°
            const incomeCountCard = document.querySelector('#dashboard_one-page .overview-card:nth-child(4)');
            if (incomeCountCard) {
                const incomeCount = account.filter(bill => bill.type === 1).length;
                const valueElement = incomeCountCard.querySelector('.card-value');
                const changeElement = incomeCountCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = incomeCount;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆæ”¶å…¥ç¬”æ•°';
            }

            // æ›´æ–°æ”¯å‡ºç¬”æ•°
            const expenseCountCard = document.querySelector('#dashboard_one-page .overview-card:nth-child(5)');
            if (expenseCountCard) {
                const expenseCount = account.filter(bill => bill.type === 0).length;
                const valueElement = expenseCountCard.querySelector('.card-value');
                const changeElement = expenseCountCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = expenseCount;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆæ”¯å‡ºç¬”æ•°';
            }
        }




        // è·å–å®¶åº­æ‰€æœ‰è´¦å•æ•°æ®
        async function getFamilyBillsData(year, month) {
            try {
                // è®¡ç®—æœˆä»½çš„å¼€å§‹å’Œç»“æŸæ—¥æœŸ
                const startDate = `${year}-${month.toString().padStart(2, '0')}-01`;
                const lastDay = new Date(year, month, 0).getDate();
                const endDate = `${year}-${month.toString().padStart(2, '0')}-${lastDay}`;

                // è·å–æ‰€æœ‰å®¶åº­æˆå‘˜çš„è´¦å•æ•°æ®ï¼ˆä¸ä¼ memberå‚æ•°ï¼‰
                const response = await axios({
                    method: 'get',
                    url: baseUrl + '/api/v1/bills',
                    headers: { 'Content-Type': 'application/json', Authorization: token },
                    params: {
                        start_date: startDate,
                        end_date: endDate
                    }
                });

                if (response.data.message === "OK") {
                    const allBills = response.data.response.bills || [];
                    console.log('å®¶åº­æ‰€æœ‰è´¦å•æ•°æ®:', allBills);

                    // æŒ‰æ—¶é—´æ’åºï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰
                    const sortedBills = allBills.sort((a, b) => new Date(b.occurred_at) - new Date(a.occurred_at));

                    return sortedBills;
                }

                return [];
            } catch (err) {
                console.log('è·å–å®¶åº­è´¦å•æ•°æ®å¤±è´¥:', err);
                return [];
            }
        }

        // æ›´æ–°å®¶åº­æ•°æ®
        async function updateFamilyData() {
            const now = new Date();
            const currentYear = now.getFullYear();
            const currentMonth = now.getMonth() + 1;

            try {
                // ç›´æ¥ä½¿ç”¨ç»Ÿè®¡APIè·å–å®¶åº­æ€»æ”¶å…¥/æ”¯å‡º
                const [totalIncome, totalExpense] = await Promise.all([
                    getMonthlyData('income', currentYear, currentMonth),
                    getMonthlyData('outcome', currentYear, currentMonth)
                ]);

                const totalBalance = totalIncome - totalExpense;

                console.log('å®¶åº­æ€»æ”¶å…¥:', totalIncome, 'å®¶åº­æ€»æ”¯å‡º:', totalExpense, 'å®¶åº­æ€»ç»“ä½™:', totalBalance);

                // è·å–å®¶åº­æ‰€æœ‰è´¦å•æ•°æ®
                const familyBills = await getFamilyBillsData(currentYear, currentMonth);

                // æ›´æ–°å„ä¸ªé¡µé¢çš„æ•°æ®
                updateFamilyIncomePage(totalIncome, familyBills);
                updateFamilyExpensePage(totalExpense, familyBills);
                updateFamilyOverviewPage(totalIncome, totalExpense, totalBalance, familyBills);

            } catch (err) {
                console.log('æ›´æ–°å®¶åº­æ•°æ®å¤±è´¥:', err);
            }
        }

        // æ¸²æŸ“å®¶åº­äº¤æ˜“è®°å½•
        function renderFamilyTransactions(transactions, limit = 5, type = 'all') {
            let filteredTransactions = transactions;

            // æ ¹æ®ç±»å‹è¿‡æ»¤äº¤æ˜“è®°å½•
            if (type === 'income') {
                filteredTransactions = transactions.filter(t => t.type === 1);
            } else if (type === 'expense') {
                filteredTransactions = transactions.filter(t => t.type === 0);
            }

            const recentTransactions = limit ? filteredTransactions.slice(0, limit) : filteredTransactions;

            let html = `
                <div class="transactions-header">
                    <h3>æœ€è¿‘äº¤æ˜“è®°å½•</h3>
                    <a href="#" class="view-all-btn" onclick="showAllFamilyTransactions('${type}')">æŸ¥çœ‹å…¨éƒ¨</a>
                </div>
            `;

            if (recentTransactions.length === 0) {
                html += '<div class="no-transactions">æš‚æ— äº¤æ˜“è®°å½•</div>';
            } else {
                recentTransactions.forEach(transaction => {
                    const isIncome = transaction.type === 1;
                    const amount = parseFloat(transaction.amount);
                    let formattedDate;

                    if (transaction.occurred_at) {
                        let date;
                        if (typeof transaction.occurred_at === 'string') {
                            date = new Date(transaction.occurred_at);
                        } else if (typeof transaction.occurred_at === 'number') {
                            date = new Date(transaction.occurred_at * 1000);
                        } else {
                            date = new Date(transaction.occurred_at);
                        }

                        if (isNaN(date.getTime())) {
                            formattedDate = 'æ—¥æœŸæ— æ•ˆ';
                        } else {
                            const y = date.getFullYear();
                            const m = String(date.getMonth() + 1).padStart(2, '0');
                            const d = String(date.getDate()).padStart(2, '0');
                            formattedDate = `${y}-${m}-${d}`;
                        }
                    } else {
                        formattedDate = 'æ— æ—¥æœŸ';
                    }

                    const icon = getCategoryIcon(transaction.category);
                    html += `
                        <div class="transaction-item">
                            <div class="transaction-info">
                                <div class="transaction-icon">${icon}</div>
                                <div class="transaction-details">
                                    <h4>${transaction.note || transaction.category}</h4>
                                    <p>${formattedDate} | ${transaction.category} | ${transaction.member || 'æœªçŸ¥æˆå‘˜'}</p>
                                </div>
                            </div>
                            <div class="transaction-amount ${isIncome ? 'amount-income' : 'amount-expense'}">
                                ${isIncome ? '+' : '-'}Â¥${amount.toFixed(2)}
                            </div>
                        </div>
                    `;
                });
            }

            return html;
        }

        // æ›´æ–°å®¶åº­æ”¶å…¥ç®¡ç†é¡µé¢
        function updateFamilyIncomePage(totalIncome, familyBills) {
            const container = document.querySelector('#income-page .overview-cards');
            if (!container) return;

            // æ›´æ–°æ€»æ”¶å…¥å¡ç‰‡
            const totalCard = container.querySelector('.overview-card:first-child');
            if (totalCard) {
                const valueElement = totalCard.querySelector('.card-value');
                const changeElement = totalCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = `Â¥${totalIncome.toLocaleString()}`;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆå®¶åº­æ€»æ”¶å…¥';
            }

            // æ›´æ–°æ”¶å…¥ç¬”æ•°å¡ç‰‡
            const countCard = container.querySelector('.overview-card:nth-child(2)');
            if (countCard) {
                const incomeCount = familyBills.filter(bill => bill.type === 1).length;
                const valueElement = countCard.querySelector('.card-value');
                const changeElement = countCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = incomeCount;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆæ”¶å…¥ç¬”æ•°';
            }

            // æ›´æ–°æ”¶å…¥äº¤æ˜“è®°å½•
            const transactionsContainer = document.querySelector('#income-page .recent-transactions');
            if (transactionsContainer) {
                transactionsContainer.innerHTML = renderFamilyTransactions(familyBills, 5, 'income');
            }
        }

        // æ›´æ–°å®¶åº­æ”¯å‡ºç®¡ç†é¡µé¢
        function updateFamilyExpensePage(totalExpense, familyBills) {
            const container = document.querySelector('#expense-page .overview-cards');
            if (!container) return;

            // æ›´æ–°æ€»æ”¯å‡ºå¡ç‰‡
            const totalCard = container.querySelector('.overview-card:first-child');
            if (totalCard) {
                const valueElement = totalCard.querySelector('.card-value');
                const changeElement = totalCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = `Â¥${totalExpense.toLocaleString()}`;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆå®¶åº­æ€»æ”¯å‡º';
            }

            // æ›´æ–°æ”¯å‡ºç¬”æ•°å¡ç‰‡
            const countCard = container.querySelector('.overview-card:nth-child(2)');
            if (countCard) {
                const expenseCount = familyBills.filter(bill => bill.type === 0).length;
                const valueElement = countCard.querySelector('.card-value');
                const changeElement = countCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = expenseCount;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆæ”¯å‡ºç¬”æ•°';
            }

            // æ›´æ–°æ”¯å‡ºäº¤æ˜“è®°å½•
            const transactionsContainer = document.querySelector('#expense-page .recent-transactions');
            if (transactionsContainer) {
                transactionsContainer.innerHTML = renderFamilyTransactions(familyBills, 5, 'expense');
            }
        }

        // æ›´æ–°å®¶åº­æ¦‚è§ˆé¡µé¢
        function updateFamilyOverviewPage(totalIncome, totalExpense, totalBalance, familyBills) {
            const container = document.querySelector('#dashboard-page .overview-cards');
            if (!container) return;

            // æ›´æ–°æ”¶å…¥å¡ç‰‡
            const incomeCard = container.querySelector('.overview-card:nth-child(1)');
            if (incomeCard) {
                const valueElement = incomeCard.querySelector('.card-value');
                const changeElement = incomeCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = `Â¥${totalIncome.toLocaleString()}`;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆå®¶åº­æ”¶å…¥';
            }

            // æ›´æ–°æ”¯å‡ºå¡ç‰‡
            const expenseCard = container.querySelector('.overview-card:nth-child(2)');
            if (expenseCard) {
                const valueElement = expenseCard.querySelector('.card-value');
                const changeElement = expenseCard.querySelector('.card-change');
                console.log('å®¶åº­æ¦‚è§ˆ - æ›´æ–°æ”¯å‡ºå¡ç‰‡:', totalExpense, 'valueElement:', valueElement);
                if (valueElement) valueElement.textContent = `Â¥${totalExpense.toLocaleString()}`;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆå®¶åº­æ”¯å‡º';
            } else {
                console.log('å®¶åº­æ¦‚è§ˆ - æœªæ‰¾åˆ°æ”¯å‡ºå¡ç‰‡å…ƒç´ ');
            }

            // æ›´æ–°ç»“ä½™å¡ç‰‡
            const balanceCard = container.querySelector('.overview-card:nth-child(3)');
            if (balanceCard) {
                const valueElement = balanceCard.querySelector('.card-value');
                const changeElement = balanceCard.querySelector('.card-change');
                if (valueElement) valueElement.textContent = `Â¥${totalBalance.toLocaleString()}`;
                if (changeElement) changeElement.textContent = 'æœ¬æœˆå®¶åº­ç»“ä½™';
            }

            // æ›´æ–°å‰©ä½™é¢„ç®—
            updateRemainingBudget(totalExpense);

            // æ›´æ–°å®¶åº­äº¤æ˜“è®°å½•
            const transactionsContainer = document.querySelector('#dashboard-page .recent-transactions');
            if (transactionsContainer) {
                transactionsContainer.innerHTML = renderFamilyTransactions(familyBills, 5, 'all');
            }
        }

        // æ˜¾ç¤ºæ‰€æœ‰å®¶åº­äº¤æ˜“è®°å½•
        function showAllFamilyTransactions(type = 'all') {
            openFamilyTransactionsModal(type);
        }

        // æ‰“å¼€å®¶åº­äº¤æ˜“è®°å½•å¼¹çª—
        function openFamilyTransactionsModal(type = 'all') {
            const modal = document.getElementById('familyTransactionsModal');
            const transactionsList = document.getElementById('familyTransactionsList');
            const titleElement = document.getElementById('familyTransactionsTitle');
            if (!modal || !transactionsList) return;

            // è®¾ç½®å¼¹çª—æ ‡é¢˜
            if (titleElement) {
                if (type === 'income') {
                    titleElement.textContent = 'å®¶åº­æ”¶å…¥è®°å½•';
                } else if (type === 'expense') {
                    titleElement.textContent = 'å®¶åº­æ”¯å‡ºè®°å½•';
                } else {
                    titleElement.textContent = 'å®¶åº­äº¤æ˜“è®°å½•';
                }
            }

            // è·å–å®¶åº­è´¦å•æ•°æ®
            const now = new Date();
            const currentYear = now.getFullYear();
            const currentMonth = now.getMonth() + 1;

            getFamilyBillsData(currentYear, currentMonth).then(familyBills => {
                // å­˜å‚¨åŸå§‹æ•°æ®ç”¨äºç­›é€‰
                window.currentFamilyBills = familyBills;
                window.currentFamilyBillsType = type;

                // åˆå§‹åŒ–ç­›é€‰å™¨
                initFamilyTransactionsFilters(type);

                // æ¸²æŸ“äº¤æ˜“è®°å½•
                renderFilteredFamilyTransactions(familyBills, type);

                modal.style.display = 'block';
            }).catch(err => {
                console.log('è·å–å®¶åº­è´¦å•æ•°æ®å¤±è´¥:', err);
                transactionsList.innerHTML = '<div class="no-transactions">è·å–æ•°æ®å¤±è´¥</div>';
                modal.style.display = 'block';
            });
        }

        // åˆå§‹åŒ–å®¶åº­äº¤æ˜“è®°å½•ç­›é€‰å™¨
        function initFamilyTransactionsFilters(type) {
            const categoryFilter = document.getElementById('familyCategoryFilter');
            const memberFilter = document.getElementById('familyMemberFilter');

            if (!categoryFilter || !memberFilter) return;

            // æ ¹æ®ç±»å‹è®¾ç½®åˆ†ç±»é€‰é¡¹
            if (type === 'income') {
                categoryFilter.innerHTML = `
                    <option value="all">å…¨éƒ¨</option>
                    <option value="å·¥èµ„">å·¥èµ„</option>
                    <option value="å¥–é‡‘">å¥–é‡‘</option>
                    <option value="æŠ•èµ„å—ç›Š">æŠ•èµ„</option>
                    <option value="å…¶ä»–">å…¶ä»–</option>
                `;
            } else if (type === 'expense') {
                categoryFilter.innerHTML = `
                    <option value="all">å…¨éƒ¨</option>
                    <option value="é¤é¥®">é¤é¥®</option>
                    <option value="è´­ç‰©">è´­ç‰©</option>
                    <option value="äº¤é€š">äº¤é€š</option>
                    <option value="å¨±ä¹">å¨±ä¹</option>
                    <option value="åŒ»ç–—">åŒ»ç–—</option>
                    <option value="æ•™è‚²">æ•™è‚²</option>
                    <option value="å…¶ä»–">å…¶ä»–</option>
                `;
            } else {
                categoryFilter.innerHTML = `
                    <option value="all">å…¨éƒ¨</option>
                    <option value="å·¥èµ„">å·¥èµ„</option>
                    <option value="å¥–é‡‘">å¥–é‡‘</option>
                    <option value="æŠ•èµ„">æŠ•èµ„</option>
                    <option value="é¤é¥®">é¤é¥®</option>
                    <option value="è´­ç‰©">è´­ç‰©</option>
                    <option value="äº¤é€š">äº¤é€š</option>
                    <option value="å¨±ä¹">å¨±ä¹</option>
                    <option value="åŒ»ç–—">åŒ»ç–—</option>
                    <option value="æ•™è‚²">æ•™è‚²</option>
                    <option value="å…¶ä»–">å…¶ä»–</option>
                `;
            }

            // è®¾ç½®æˆå‘˜é€‰é¡¹
            memberFilter.innerHTML = '<option value="all">å…¨éƒ¨æˆå‘˜</option>';
            if (window.currentFamilyBills) {
                const uniqueMembers = [...new Set(window.currentFamilyBills.map(bill => bill.member).filter(member => member))];
                uniqueMembers.forEach(member => {
                    memberFilter.innerHTML += `<option value="${member}">${member}</option>`;
                });
            }

            // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            categoryFilter.onchange = () => applyFamilyTransactionsFilter();
            memberFilter.onchange = () => applyFamilyTransactionsFilter();
        }

        // åº”ç”¨å®¶åº­äº¤æ˜“è®°å½•ç­›é€‰
        function applyFamilyTransactionsFilter() {
            if (!window.currentFamilyBills) return;

            const categoryFilter = document.getElementById('familyCategoryFilter');
            const memberFilter = document.getElementById('familyMemberFilter');

            if (!categoryFilter || !memberFilter) return;

            const selectedCategory = categoryFilter.value;
            const selectedMember = memberFilter.value;

            let filteredBills = window.currentFamilyBills;

            // æŒ‰ç±»å‹ç­›é€‰
            if (window.currentFamilyBillsType === 'income') {
                filteredBills = filteredBills.filter(bill => bill.type === 1);
            } else if (window.currentFamilyBillsType === 'expense') {
                filteredBills = filteredBills.filter(bill => bill.type === 0);
            }

            // æŒ‰åˆ†ç±»ç­›é€‰
            if (selectedCategory !== 'all') {
                filteredBills = filteredBills.filter(bill => bill.category === selectedCategory);
            }

            // æŒ‰æˆå‘˜ç­›é€‰
            if (selectedMember !== 'all') {
                filteredBills = filteredBills.filter(bill => bill.member === selectedMember);
            }

            // é‡æ–°æ¸²æŸ“
            renderFilteredFamilyTransactions(filteredBills, window.currentFamilyBillsType);
        }

        // æ¸²æŸ“ç­›é€‰åçš„å®¶åº­äº¤æ˜“è®°å½•
        function renderFilteredFamilyTransactions(transactions, type) {
            const transactionsList = document.getElementById('familyTransactionsList');
            if (!transactionsList) return;

            if (transactions.length === 0) {
                transactionsList.innerHTML = '<div class="no-transactions">æš‚æ— ç¬¦åˆæ¡ä»¶çš„äº¤æ˜“è®°å½•</div>';
                return;
            }

            let html = '';
            transactions.forEach(transaction => {
                const isIncome = transaction.type === 1;
                const amount = parseFloat(transaction.amount);
                let formattedDate;

                if (transaction.occurred_at) {
                    let date;
                    if (typeof transaction.occurred_at === 'string') {
                        date = new Date(transaction.occurred_at);
                    } else if (typeof transaction.occurred_at === 'number') {
                        date = new Date(transaction.occurred_at * 1000);
                    } else {
                        date = new Date(transaction.occurred_at);
                    }

                    if (isNaN(date.getTime())) {
                        formattedDate = 'æ—¥æœŸæ— æ•ˆ';
                    } else {
                        const y = date.getFullYear();
                        const m = String(date.getMonth() + 1).padStart(2, '0');
                        const d = String(date.getDate()).padStart(2, '0');
                        formattedDate = `${y}-${m}-${d}`;
                    }
                } else {
                    formattedDate = 'æ— æ—¥æœŸ';
                }

                const icon = getCategoryIcon(transaction.category);

                html += `
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <div class="transaction-icon">${icon}</div>
                            <div class="transaction-details">
                                <h4>${transaction.note || transaction.category}</h4>
                                <p>${formattedDate} | ${transaction.category} | ${transaction.member || 'æœªçŸ¥æˆå‘˜'}</p>
                            </div>
                        </div>
                        <div class="transaction-amount ${isIncome ? 'amount-income' : 'amount-expense'}">
                            ${isIncome ? '+' : '-'}Â¥${amount.toFixed(2)}
                        </div>
                    </div>
                `;
            });

            transactionsList.innerHTML = html;
        }

        // åœ¨é¡µé¢åŠ è½½æ—¶æ›´æ–°å®¶åº­æ•°æ®
        updateFamilyData();

        // é¢„ç®—ç›¸å…³å‡½æ•°
        async function fetchCurrentBudget() {            
            try {
                const startDate = getBudgetMonthStartDate();
                const response = await axios({
                    method: 'get',
                    url: baseUrl + '/api/v1/budget',
                    headers: { 'Content-Type': 'application/json', Authorization: token },
                    params: { start_date: startDate }
                });
                // ç»Ÿä¸€æŒ‰ç…§åç«¯é€šç”¨å“åº”ç»“æ„è¯»å–
                if (response && response.data && response.data.response) {
                    const resp = response.data.response;
                    // å…¼å®¹ä¸¤ç§å¯èƒ½ï¼šç›´æ¥è¿”å›Budgetå¯¹è±¡æˆ–åŒ…åœ¨budgetå­—æ®µé‡Œ
                    currentBudget = normalizeBudget(resp.budget ? resp.budget : resp);
                    // åŒæ­¥å†™å…¥æœ¬åœ°ç¼“å­˜
                    if (currentBudget) {
                        saveBudgetToLocal(currentBudget);
                    }
                } else {
                    currentBudget = null;
                }
            } catch (err) {
                console.log('è·å–é¢„ç®—å¤±è´¥:', err);
                currentBudget = null;
            }
        }

        function getCurrentBudget() {
            return currentBudget || loadBudgetFromLocal();
        }

        // æ›´æ–°é¢„ç®—æ˜¾ç¤º
        function updateBudgetDisplay() {
            const budget = normalizeBudget(getCurrentBudget());
            const budgetDisplay = document.getElementById('budgetDisplay');
            const budgetAmount = document.getElementById('budgetAmount');

            if (budget && budget.amount > 0) {
                budgetDisplay.style.display = 'flex';
                // æ˜¾ç¤ºé¢„ç®—é‡‘é¢å’Œå¤‡æ³¨
                let displayText = `Â¥${Number(budget.amount).toLocaleString()}`;
                if (budget.note && budget.note.trim()) {
                    displayText += ` (${budget.note})`;
                }
                budgetAmount.textContent = displayText;
            } else {
                budgetDisplay.style.display = 'none';
            }
        }

        // è®¡ç®—å‰©ä½™é¢„ç®—
        function calculateRemainingBudget(totalExpense) {
            const budget = normalizeBudget(getCurrentBudget());
            if (!budget || budget.amount <= 0) {
                return 0;
            }

            const remaining = budget.amount - totalExpense;
            return remaining; // å…è®¸æ˜¾ç¤ºè´Ÿæ•°
        }

        // æ›´æ–°å‰©ä½™é¢„ç®—æ˜¾ç¤º
        function updateRemainingBudget(totalExpense) {
            const remainingBudget = calculateRemainingBudget(totalExpense);
            const budgetCard = document.querySelector('#dashboard-page .overview-card:nth-child(4)');

            if (budgetCard) {
                const valueElement = budgetCard.querySelector('.card-value');
                if (valueElement) {
                    // æ ¼å¼åŒ–æ˜¾ç¤ºé‡‘é¢
                    let displayAmount = remainingBudget.toLocaleString();
                    if (remainingBudget < 0) {
                        // è´Ÿæ•°æ˜¾ç¤ºä¸ºçº¢è‰²
                        valueElement.style.color = '#dc3545';
                        valueElement.textContent = `-Â¥${Math.abs(remainingBudget).toLocaleString()}`;
                    } else {
                        // æ­£æ•°æ˜¾ç¤ºä¸ºæ­£å¸¸é¢œè‰²
                        valueElement.style.color = '';
                        valueElement.textContent = `Â¥${displayAmount}`;
                    }
                }
            }
        }

        // æ•°æ®ç»Ÿè®¡ç›¸å…³å‡½æ•°
        // è·å–æœ€è¿‘6ä¸ªæœˆçš„æ•°æ®ï¼ˆç®€åŒ–ç‰ˆï¼‰
        async function getMonthlyStatisticsData() {
            const now = new Date();
            const data = [];

            // åªè·å–æœ€è¿‘6ä¸ªæœˆ
            for (let i = 5; i >= 0; i--) {
                const date = new Date(now.getFullYear(), now.getMonth() - i, 1);
                const year = date.getFullYear();
                const month = date.getMonth() + 1;

                try {
                    const [income, expense] = await Promise.all([
                        getMonthlyData('income', year, month),
                        getMonthlyData('outcome', year, month)
                    ]);

                    const balance = income - expense;
                    const monthName = `${year}å¹´${month}æœˆ`;

                    data.push({
                        month: monthName,
                        year: year,
                        monthNum: month,
                        income: income,
                        expense: expense,
                        balance: balance
                    });
                } catch (err) {
                    console.log(`è·å–${year}å¹´${month}æœˆæ•°æ®å¤±è´¥:`, err);
                    data.push({
                        month: `${year}å¹´${month}æœˆ`,
                        year: year,
                        monthNum: month,
                        income: 0,
                        expense: 0,
                        balance: 0
                    });
                }
            }

            return data;
        }

        // è·å–æœ€è¿‘6ä¸ªæœˆçš„åˆ†ç±»ç»Ÿè®¡æ•°æ®

        async function getCategoryStatistics() {
            const now = new Date();
            const incomeCategories = {};
            const expenseCategories = {};
            let totalTransactions = 0;

            // åªè·å–æœ€è¿‘6ä¸ªæœˆ
            for (let i = 5; i >= 0; i--) {
                const date = new Date(now.getFullYear(), now.getMonth() - i, 1);
                const year = date.getFullYear();
                const month = date.getMonth() + 1;

                try {
                    // è®¡ç®—æœˆä»½çš„å¼€å§‹å’Œç»“æŸæ—¥æœŸ
                    const startDate = `${year}-${month.toString().padStart(2, '0')}-01`;
                    const lastDay = new Date(year, month, 0).getDate();
                    const endDate = `${year}-${month.toString().padStart(2, '0')}-${lastDay}`;

                    const response = await axios({
                        method: 'get',
                        url: baseUrl + '/api/v1/bills',
                        headers: { 'Content-Type': 'application/json', Authorization: token },
                        params: {
                            start_date: startDate,
                            end_date: endDate
                        }
                    });

                    if (response.data.message === "OK") {
                        const bills = response.data.response.bills || [];
                        totalTransactions += bills.length;

                        bills.forEach(bill => {
                            const category = bill.category || 'å…¶ä»–';
                            const amount = bill.amount || 0;

                            if (bill.type === 1) { // æ”¶å…¥
                                incomeCategories[category] = (incomeCategories[category] || 0) + amount;
                            } else { // æ”¯å‡º
                                expenseCategories[category] = (expenseCategories[category] || 0) + amount;
                            }
                        });
                    }
                } catch (err) {
                    console.log(`è·å–${year}å¹´${month}æœˆåˆ†ç±»æ•°æ®å¤±è´¥:`, err);
                }
            }

            return {
                incomeCategories,
                expenseCategories,
                totalTransactions
            };
        }

        // æ›´æ–°ç»Ÿè®¡æ¦‚è§ˆå¡ç‰‡
        function updateStatisticsOverview(monthlyData, categoryData) {
            if (!monthlyData || monthlyData.length === 0) return;

            // è®¡ç®—å¹³å‡å€¼
            const totalIncome = monthlyData.reduce((sum, item) => sum + item.income, 0);
            const totalExpense = monthlyData.reduce((sum, item) => sum + item.expense, 0);
            const totalBalance = monthlyData.reduce((sum, item) => sum + item.balance, 0);

            const avgIncome = totalIncome / monthlyData.length;
            const avgExpense = totalExpense / monthlyData.length;
            const avgBalance = totalBalance / monthlyData.length;

            // è®¡ç®—å˜åŒ–è¶‹åŠ¿ï¼ˆä¸ä¸Šä¸ªæœˆæ¯”è¾ƒï¼‰
            const currentMonth = monthlyData[monthlyData.length - 1];
            const previousMonth = monthlyData[monthlyData.length - 2];

            const incomeChange = previousMonth ?
                ((currentMonth.income - previousMonth.income) / previousMonth.income * 100).toFixed(1) : 0;
            const expenseChange = previousMonth ?
                ((currentMonth.expense - previousMonth.expense) / previousMonth.expense * 100).toFixed(1) : 0;
            const balanceChange = previousMonth ?
                ((currentMonth.balance - previousMonth.balance) / Math.abs(previousMonth.balance) * 100).toFixed(1) : 0;

            // æ›´æ–°DOM
            document.getElementById('avgIncome').textContent = `Â¥${avgIncome.toLocaleString()}`;
            document.getElementById('avgExpense').textContent = `Â¥${avgExpense.toLocaleString()}`;
            document.getElementById('avgBalance').textContent = `Â¥${avgBalance.toLocaleString()}`;
            document.getElementById('totalTransactions').textContent = categoryData.totalTransactions;

            // æ›´æ–°å˜åŒ–è¶‹åŠ¿
            const incomeChangeEl = document.getElementById('avgIncomeChange');
            const expenseChangeEl = document.getElementById('avgExpenseChange');
            const balanceChangeEl = document.getElementById('avgBalanceChange');

            if (incomeChangeEl) {
                incomeChangeEl.textContent = `${incomeChange >= 0 ? '+' : ''}${incomeChange}% è¾ƒä¸Šæœˆ`;
                incomeChangeEl.className = `card-change ${incomeChange >= 0 ? 'positive' : 'negative'}`;
            }

            if (expenseChangeEl) {
                expenseChangeEl.textContent = `${expenseChange >= 0 ? '+' : ''}${expenseChange}% è¾ƒä¸Šæœˆ`;
                expenseChangeEl.className = `card-change ${expenseChange >= 0 ? 'negative' : 'positive'}`;
            }

            if (balanceChangeEl) {
                balanceChangeEl.textContent = `${balanceChange >= 0 ? '+' : ''}${balanceChange}% è¾ƒä¸Šæœˆ`;
                balanceChangeEl.className = `card-change ${balanceChange >= 0 ? 'positive' : 'negative'}`;
            }
        }

        // åˆå§‹åŒ–æœˆåº¦è¶‹åŠ¿å›¾è¡¨
        function initMonthlyTrendChart(monthlyData) {
            const chart = echarts.init(document.getElementById('monthlyTrendChart'));

            const months = monthlyData.map(item => item.month);
            const incomeData = monthlyData.map(item => item.income);
            const expenseData = monthlyData.map(item => item.expense);
            const balanceData = monthlyData.map(item => item.balance);

            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross'
                    },
                    formatter: function (params) {
                        let result = params[0].name + '<br/>';
                        params.forEach(param => {
                            result += `${param.marker} ${param.seriesName}: Â¥${param.value.toLocaleString()}<br/>`;
                        });
                        return result;
                    }
                },
                legend: {
                    data: ['æ”¶å…¥', 'æ”¯å‡º', 'ç»“ä½™'],
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: months,
                    axisLabel: {
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    axisLabel: {
                        formatter: 'Â¥{value}'
                    }
                },
                series: [
                    {
                        name: 'æ”¶å…¥',
                        type: 'line',
                        data: incomeData,
                        smooth: true,
                        itemStyle: {
                            color: '#28a745'
                        },
                        areaStyle: {
                            color: {
                                type: 'linear',
                                x: 0,
                                y: 0,
                                x2: 0,
                                y2: 1,
                                colorStops: [{
                                    offset: 0, color: 'rgba(40, 167, 69, 0.3)'
                                }, {
                                    offset: 1, color: 'rgba(40, 167, 69, 0.1)'
                                }]
                            }
                        }
                    },
                    {
                        name: 'æ”¯å‡º',
                        type: 'line',
                        data: expenseData,
                        smooth: true,
                        itemStyle: {
                            color: '#dc3545'
                        },
                        areaStyle: {
                            color: {
                                type: 'linear',
                                x: 0,
                                y: 0,
                                x2: 0,
                                y2: 1,
                                colorStops: [{
                                    offset: 0, color: 'rgba(220, 53, 69, 0.3)'
                                }, {
                                    offset: 1, color: 'rgba(220, 53, 69, 0.1)'
                                }]
                            }
                        }
                    },
                    {
                        name: 'ç»“ä½™',
                        type: 'line',
                        data: balanceData,
                        smooth: true,
                        itemStyle: {
                            color: '#007bff'
                        }
                    }
                ]
            };

            chart.setOption(option);

            // å“åº”å¼è°ƒæ•´
            window.addEventListener('resize', function () {
                chart.resize();
            });
        }

        // åˆå§‹åŒ–æ”¶æ”¯å¯¹æ¯”å›¾è¡¨
        function initIncomeExpenseChart(monthlyData) {
            const chart = echarts.init(document.getElementById('incomeExpenseChart'));

            const months = monthlyData.map(item => item.month);
            const incomeData = monthlyData.map(item => item.income);
            const expenseData = monthlyData.map(item => item.expense);

            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['æ”¶å…¥', 'æ”¯å‡º'],
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: months,
                    axisLabel: {
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    axisLabel: {
                        formatter: 'Â¥{value}'
                    }
                },
                series: [
                    {
                        name: 'æ”¶å…¥',
                        type: 'bar',
                        data: incomeData,
                        itemStyle: {
                            color: '#28a745'
                        }
                    },
                    {
                        name: 'æ”¯å‡º',
                        type: 'bar',
                        data: expenseData,
                        itemStyle: {
                            color: '#dc3545'
                        }
                    }
                ]
            };

            chart.setOption(option);

            // å“åº”å¼è°ƒæ•´
            window.addEventListener('resize', function () {
                chart.resize();
            });
        }

        // åˆå§‹åŒ–æ”¯å‡ºåˆ†ç±»å›¾è¡¨
        function initExpenseCategoryChart(categoryData) {
            const chart = echarts.init(document.getElementById('expenseCategoryChart'));

            const categories = Object.keys(categoryData.expenseCategories);
            const data = categories.map(category => ({
                name: category,
                value: categoryData.expenseCategories[category]
            })).sort((a, b) => b.value - a.value);

            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: Â¥{c} ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    left: 'left',
                    top: 'middle'
                },
                series: [
                    {
                        name: 'æ”¯å‡ºåˆ†ç±»',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        center: ['60%', '50%'],
                        data: data,
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        },
                        label: {
                            formatter: '{b}: Â¥{c}'
                        }
                    }
                ]
            };

            chart.setOption(option);

            // å“åº”å¼è°ƒæ•´
            window.addEventListener('resize', function () {
                chart.resize();
            });
        }

        // åˆå§‹åŒ–æ”¶å…¥åˆ†ç±»å›¾è¡¨
        function initIncomeCategoryChart(categoryData) {
            const chart = echarts.init(document.getElementById('incomeCategoryChart'));

            const categories = Object.keys(categoryData.incomeCategories);
            const data = categories.map(category => ({
                name: category,
                value: categoryData.incomeCategories[category]
            })).sort((a, b) => b.value - a.value);

            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: Â¥{c} ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    left: 'left',
                    top: 'middle'
                },
                series: [
                    {
                        name: 'æ”¶å…¥åˆ†ç±»',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        center: ['60%', '50%'],
                        data: data,
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        },
                        label: {
                            formatter: '{b}: Â¥{c}'
                        }
                    }
                ]
            };

            chart.setOption(option);

            // å“åº”å¼è°ƒæ•´
            window.addEventListener('resize', function () {
                chart.resize();
            });
        }

        // åˆ·æ–°ç»Ÿè®¡æ•°æ®ï¼ˆç®€åŒ–ç‰ˆï¼Œå›ºå®š6ä¸ªæœˆï¼‰
        async function refreshStatistics() {
            try {
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                const refreshBtn = document.querySelector('.refresh-btn');
                const originalText = refreshBtn.innerHTML;
                refreshBtn.innerHTML = '<span>â³</span><span>åŠ è½½ä¸­...</span>';
                refreshBtn.disabled = true;

                // è·å–æœ€è¿‘6ä¸ªæœˆæ•°æ®
                const [monthlyData, categoryData] = await Promise.all([
                    getMonthlyStatisticsData(),
                    getCategoryStatistics()
                ]);

                // æ›´æ–°æ¦‚è§ˆå¡ç‰‡
                updateStatisticsOverview(monthlyData, categoryData);

                // åˆå§‹åŒ–å›¾è¡¨
                initMonthlyTrendChart(monthlyData);
                initIncomeExpenseChart(monthlyData);
                initExpenseCategoryChart(categoryData);
                initIncomeCategoryChart(categoryData);

                // æ¢å¤æŒ‰é’®çŠ¶æ€
                refreshBtn.innerHTML = originalText;
                refreshBtn.disabled = false;

                console.log('ç»Ÿè®¡æ•°æ®åˆ·æ–°å®Œæˆ');
            } catch (err) {
                console.log('åˆ·æ–°ç»Ÿè®¡æ•°æ®å¤±è´¥:', err);
                alert('åˆ·æ–°æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');

                // æ¢å¤æŒ‰é’®çŠ¶æ€
                const refreshBtn = document.querySelector('.refresh-btn');
                refreshBtn.innerHTML = '<span>ğŸ”„</span><span>åˆ·æ–°æ•°æ®</span>';
                refreshBtn.disabled = false;
            }
        }

        // é¡µé¢åˆ‡æ¢æ—¶åˆå§‹åŒ–ç»Ÿè®¡é¡µé¢
        function initStatisticsPage() {
            // å¦‚æœç»Ÿè®¡é¡µé¢å¯è§ï¼Œåˆ™åˆå§‹åŒ–æ•°æ®
            const statisticsPage = document.getElementById('statistics-page');
            if (statisticsPage && statisticsPage.style.display !== 'none') {
                refreshStatistics();
            }
        }

        // é¢„ç®—
        // axios({
        //     method: 'post',
        //     url: baseUrl + '/api/v1/budget',
        //     headers: { 'Content-Type': 'application/json', Authorization: token },
        //     data: {
        //         amount: 10000,
        //         start_date: "2025-9-9",
        //         note: "none"
        //     }
        // }).then(response => {

        //     console.log(response);

        // }).catch(err => {
        //     console.log(err);
        //     alert('å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
        // });







        //å±•ç¤ºç”¨æˆ·å
        document.querySelector('.user-welcome').innerText = "æ¬¢è¿," + username;

        // è·å–/åˆ·æ–°å®¶åº­æˆå‘˜åˆ—è¡¨
        function fetchMembers() {
            return axios({
                method: 'get',
                url: baseUrl + '/api/v1/family/members',
                headers: { Authorization: token }
            }).then(response => {
                try {
                    const data = response && response.data;
                    const list = Array.isArray(data) ? data :
                        (Array.isArray(data && data.data) ? data.data :
                            (Array.isArray(data && data.response && data.response.members) ? data.response.members :
                                (Array.isArray(data && data.members) ? data.members : [])));
                    members = list || [];
                } catch (e) {
                    members = [];
                }
                renderFamilyStatus();
            }).catch(error => {
                console.log(error);
                members = [];
                renderFamilyStatus();
            });
        }

        // é¦–æ¬¡è¿›å…¥æ‹‰å–ä¸€æ¬¡ï¼ˆä¸é˜»å¡åˆå§‹æ¸²æŸ“ï¼‰
        fetchMembers();

        // åˆ›å»ºå®¶åº­
        function createFamily() {
            const familyname = prompt('è¯·è¾“å…¥å®¶åº­åç§°');
            if (!familyname) return;
            axios({
                method: 'post',
                url: baseUrl + '/api/v1/family',
                headers: { Authorization: token },
                data: { familyname: familyname }
            }).then(res => {
                alert('åˆ›å»ºå®¶åº­æˆåŠŸ');
                return fetchMembers();
            }).catch(err => {
                console.log(err);
                alert('åˆ›å»ºå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
            });
        }

        // é€šè¿‡ç”¨æˆ·åé‚€è¯·æˆå‘˜
        function inviteByUsername() {
            const usernameToInvite = prompt('è¯·è¾“å…¥è¦é‚€è¯·çš„ç”¨æˆ·å');
            if (!usernameToInvite) return;
            axios({
                method: 'post',
                url: baseUrl + '/api/v1/family/members',
                headers: { 'Content-Type': 'application/json', Authorization: token },
                data: { username: usernameToInvite }
            }).then(() => {
                alert('é‚€è¯·å·²å‘é€');
                return fetchMembers();
            }).catch(err => {
                console.log(err);
                alert('é‚€è¯·å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
            });
        }

        // é¢„ç•™ï¼šå¦‚éœ€åœ¨æ§åˆ¶å°æŸ¥çœ‹æˆå‘˜
        console.log('members:', members);

        // è®¡ç®—ä¸¤ä¸ªæœˆä»½ä¹‹é—´çš„è·¨åº¦ï¼ˆæŒ‰æœˆï¼‰
        function diffMonthsInclusive(startYear, startMonth, endYear, endMonth) {
            return (endYear - startYear) * 12 + (endMonth - startMonth) + 1;
        }

        // å°†èµ·æ­¢æœˆä»½æ§ä»¶è®¾ç½®ä¸ºé»˜è®¤è¿‘6ä¸ªæœˆ
        function initStatsMonthInputs() {
            const startInput = document.getElementById('statsStartMonth');
            const endInput = document.getElementById('statsEndMonth');
            if (!startInput || !endInput) return;
            const now = new Date();
            const endYear = now.getFullYear();
            const endMonth = now.getMonth() + 1;
            const startDate = new Date(endYear, endMonth - 6, 1); // è¿‘6ä¸ªæœˆï¼ˆå«æœ¬æœˆï¼‰
            const startYear = startDate.getFullYear();
            const startMonth = startDate.getMonth() + 1;
            startInput.value = `${startYear}-${String(startMonth).padStart(2, '0')}`;
            endInput.value = `${endYear}-${String(endMonth).padStart(2, '0')}`;
        }

        // è·å–æŒ‡å®šæœˆä»½èŒƒå›´çš„æ•°æ®ï¼ˆæŒ‰èµ·æ­¢æœˆä»½ï¼Œé™åˆ¶æœ€å¤š24ä¸ªæœˆï¼‰
        async function getMonthlyStatisticsDataByRange(startYear, startMonth, endYear, endMonth) {
            const maxMonths = 24;
            const span = diffMonthsInclusive(startYear, startMonth, endYear, endMonth);
            const monthsSpan = Math.min(span, maxMonths);

            const data = [];
            // è®¡ç®—ä»èµ·å§‹åˆ°ç»“æŸçš„è¿­ä»£åŸºç‚¹ï¼šå°†èŒƒå›´è£å‰ªä¸ºæœ€å¤š24ä¸ªæœˆæœ«å°¾åŒºé—´
            const endBase = new Date(endYear, endMonth - 1, 1);
            const startBase = new Date(endBase.getFullYear(), endBase.getMonth() - (monthsSpan - 1), 1);

            for (let i = 0; i < monthsSpan; i++) {
                const date = new Date(startBase.getFullYear(), startBase.getMonth() + i, 1);
                const y = date.getFullYear();
                const m = date.getMonth() + 1;
                try {
                    const [income, expense] = await Promise.all([
                        getMonthlyData('income', y, m),
                        getMonthlyData('outcome', y, m)
                    ]);
                    data.push({
                        month: `${y}å¹´${m}æœˆ`,
                        year: y,
                        monthNum: m,
                        income,
                        expense,
                        balance: income - expense
                    });
                } catch (err) {
                    console.log(`è·å–${y}å¹´${m}æœˆæ•°æ®å¤±è´¥:`, err);
                    data.push({ month: `${y}å¹´${m}æœˆ`, year: y, monthNum: m, income: 0, expense: 0, balance: 0 });
                }
            }
            return data;
        }

        // è·å–åˆ†ç±»ç»Ÿè®¡ï¼ˆåŸºäºæŒ‰æœˆfamily billsèšåˆï¼‰ï¼Œæ²¿ç”¨ç°æœ‰å®ç°ï¼Œä½†ä»¥æ‰€é€‰èŒƒå›´é©±åŠ¨
        async function getCategoryStatisticsByRange(startYear, startMonth, endYear, endMonth) {
            const maxMonths = 24;
            const span = diffMonthsInclusive(startYear, startMonth, endYear, endMonth);
            const monthsSpan = Math.min(span, maxMonths);
            const endBase = new Date(endYear, endMonth - 1, 1);
            const startBase = new Date(endBase.getFullYear(), endBase.getMonth() - (monthsSpan - 1), 1);

            const incomeCategories = {};
            const expenseCategories = {};
            let totalTransactions = 0;

            for (let i = 0; i < monthsSpan; i++) {
                const date = new Date(startBase.getFullYear(), startBase.getMonth() + i, 1);
                const y = date.getFullYear();
                const m = date.getMonth() + 1;
                try {
                    const startDate = `${y}-${String(m).padStart(2, '0')}-01`;
                    const lastDay = new Date(y, m, 0).getDate();
                    const endDate = `${y}-${String(m).padStart(2, '0')}-${lastDay}`;
                    const response = await axios({
                        method: 'get',
                        url: baseUrl + '/api/v1/bills',
                        headers: { 'Content-Type': 'application/json', Authorization: token },
                        params: { start_date: startDate, end_date: endDate }
                    });
                    if (response.data.message === 'OK') {
                        const bills = response.data.response.bills || [];
                        totalTransactions += bills.length;
                        bills.forEach(bill => {
                            const category = bill.category || 'å…¶ä»–';
                            const amount = bill.amount || 0;
                            if (bill.type === 1) {
                                incomeCategories[category] = (incomeCategories[category] || 0) + amount;
                            } else {
                                expenseCategories[category] = (expenseCategories[category] || 0) + amount;
                            }
                        });
                    }
                } catch (err) {
                    console.log(`è·å–${y}å¹´${m}æœˆåˆ†ç±»æ•°æ®å¤±è´¥:`, err);
                }
            }
            return { incomeCategories, expenseCategories, totalTransactions };
        }

        // åˆ·æ–°ç»Ÿè®¡æ•°æ®ï¼šè¯»å–èµ·æ­¢æœˆä»½ï¼ˆé»˜è®¤è¿‘6æœˆï¼‰ï¼Œé™åˆ¶è·¨åº¦24ä¸ªæœˆ
        async function refreshStatistics() {
            const startInput = document.getElementById('statsStartMonth');
            const endInput = document.getElementById('statsEndMonth');
            let startYear, startMonth, endYear, endMonth;

            if (startInput && endInput && startInput.value && endInput.value) {
                const [sy, sm] = startInput.value.split('-').map(v => parseInt(v, 10));
                const [ey, em] = endInput.value.split('-').map(v => parseInt(v, 10));
                // çº æ­£èµ·æ­¢é¢ å€’
                const startDate = new Date(sy, sm - 1, 1);
                const endDate = new Date(ey, em - 1, 1);
                if (startDate > endDate) {
                    // äº¤æ¢
                    startYear = ey; startMonth = em; endYear = sy; endMonth = sm;
                    startInput.value = `${startYear}-${String(startMonth).padStart(2, '0')}`;
                    endInput.value = `${endYear}-${String(endMonth).padStart(2, '0')}`;
                } else {
                    startYear = sy; startMonth = sm; endYear = ey; endMonth = em;
                }
            } else {
                // æ— æ§ä»¶æˆ–æœªå¡«å€¼ï¼ŒæŒ‰é»˜è®¤è¿‘6ä¸ªæœˆ
                const now = new Date();
                endYear = now.getFullYear();
                endMonth = now.getMonth() + 1;
                const startDate = new Date(endYear, endMonth - 6, 1);
                startYear = startDate.getFullYear();
                startMonth = startDate.getMonth() + 1;
            }

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const refreshBtn = document.querySelector('.refresh-btn');
            const originalText = refreshBtn ? refreshBtn.innerHTML : '';
            if (refreshBtn) { refreshBtn.innerHTML = '<span>â³</span><span>åŠ è½½ä¸­...</span>'; refreshBtn.disabled = true; }

            try {
                const [monthlyData, categoryData] = await Promise.all([
                    getMonthlyStatisticsDataByRange(startYear, startMonth, endYear, endMonth),
                    getCategoryStatisticsByRange(startYear, startMonth, endYear, endMonth)
                ]);
                updateStatisticsOverview(monthlyData, categoryData);
                initMonthlyTrendChart(monthlyData);
                initIncomeExpenseChart(monthlyData);
                initExpenseCategoryChart(categoryData);
                initIncomeCategoryChart(categoryData);
            } finally {
                if (refreshBtn) { refreshBtn.innerHTML = originalText; refreshBtn.disabled = false; }
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–æœˆä»½è¾“å…¥å¹¶é»˜è®¤åˆ·æ–°ä¸€æ¬¡
        document.addEventListener('DOMContentLoaded', function () {
            initStatsMonthInputs();
        });







    </script>
</body>

</html>